"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{3904:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});var r=a(6705),o=a(955),n=a(8647);function i(){let[e,t]=(0,o.useState)([]),[a,i]=(0,o.useState)(""),[c,d]=(0,o.useState)(!1),[s,l]=(0,o.useState)(null),p=(0,o.useRef)(null),x=async()=>{let e=a.trim();if(!e)return;let r={from:"user",text:e};t(e=>[...e,r]),i(""),d(!0);try{let a=e.toLowerCase(),r=a.includes("excel")?"xlsx":a.includes("pdf")?"pdf":a.includes("word")||a.includes(".docx")?"docx":a.includes("text")||a.includes(".txt")?"txt":null;if(r){let a=await fetch("/api/genereaza/".concat(r),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,format:r})}),o=await a.blob(),n=URL.createObjectURL(o),i="document.".concat(r),c={from:"bot",text:'Document generat: <a href="'.concat(n,'" download="').concat(i,'">Descarcă ').concat(i,"</a>")};t(e=>[...e,c])}else if(s){let a=s.name.toLowerCase().split(".").pop(),r=["pdf","xlsx","docx","txt"].includes(a||"")?"/api/proceseaza-upload/".concat(a):"/api/proceseaza-upload",o=new FormData;o.append("file",s),o.append("prompt",e);let n=await fetch(r,{method:"POST",body:o}),i=n.headers.get("Content-Type")||"";if(i.startsWith("application/json")){let e=await n.json(),a={from:"bot",text:e.reply||"Fără răspuns."};t(e=>[...e,a])}else{let e=await n.blob(),a=URL.createObjectURL(e),r=n.headers.get("X-Filename")||s.name,o={from:"bot",text:'Document generat: <a href="'.concat(a,'" download="').concat(r,'">Descarcă ').concat(r,"</a>")};t(e=>[...e,o])}l(null)}else{let a=await fetch("/api/queryOpenAI",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),r=await a.json(),o={from:"bot",text:r.reply||"Fără răspuns."};t(e=>[...e,o])}}catch(e){console.error("Eroare chatbot:",e),t(e=>[...e,{from:"bot",text:"Eroare la conectare cu serverul."}])}d(!1)},u=(0,o.useCallback)(e=>{let a=e[0];a&&(l(a),t(e=>[...e,{from:"user",text:"Am \xeencărcat fișierul: ".concat(a.name)}]))},[]),{getRootProps:f,getInputProps:h,isDragActive:b}=(0,n.uI)({onDrop:u});return(0,o.useEffect)(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),(0,r.jsxs)("div",{style:{position:"fixed",bottom:"10px",right:"10px",width:"340px",background:"#fefefe",border:"1px solid #ccc",borderRadius:"8px",zIndex:9999,boxShadow:"0 0 10px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",maxHeight:"90vh"},children:[(0,r.jsx)("div",{style:{background:"#4caf50",color:"white",padding:"10px",textAlign:"center",fontWeight:"bold",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:"Asistent AI"}),(0,r.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"10px",paddingBottom:"0"},children:[e.map((e,t)=>(0,r.jsx)("div",{style:{textAlign:"user"===e.from?"right":"left",margin:"5px 0"},children:(0,r.jsx)("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:"12px",background:"user"===e.from?"#dcf8c6":"#e0e0e0",maxWidth:"90%",wordWrap:"break-word"},children:e.text.startsWith("Document generat")?(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:e.text}}):e.text})},t)),(0,r.jsx)("div",{ref:p})]}),(0,r.jsxs)("div",{style:{padding:"10px",borderTop:"1px solid #ccc"},children:[(0,r.jsx)("textarea",{rows:3,value:a,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),x())},placeholder:"Scrie un mesaj... (Ctrl+Enter pentru a trimite)",style:{width:"100%",resize:"none",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px"}}),(0,r.jsxs)("div",{...f(),style:{border:"2px dashed #aaa",padding:"6px",textAlign:"center",marginTop:"6px",cursor:"pointer",borderRadius:"6px",background:b?"#eee":"#fafafa"},children:[(0,r.jsx)("input",{...h()}),b?"Lasa fișierele aici...":"\xcencarcă fișier"]}),(0,r.jsx)("button",{onClick:x,disabled:c,style:{marginTop:"8px",width:"100%",padding:"8px",background:"#4caf50",color:"white",border:"none",borderRadius:"6px",cursor:c?"not-allowed":"pointer"},children:c?"Se generează...":"Trimite"})]})]})}}}]);