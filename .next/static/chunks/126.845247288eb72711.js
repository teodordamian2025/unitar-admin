"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126,904],{3904:function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});var a=n(6705),r=n(955),i=n(8647);function o(){let[e,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(""),[c,s]=(0,r.useState)(!1),[l,d]=(0,r.useState)(null),u=(0,r.useRef)(null),p=async()=>{let e=n.trim();if(!e)return;let a={from:"user",text:e};t(e=>[...e,a]),o(""),s(!0);try{let n=e.toLowerCase(),a=n.includes("excel")?"xlsx":n.includes("pdf")?"pdf":n.includes("word")||n.includes(".docx")?"docx":n.includes("text")||n.includes(".txt")?"txt":null;if(a){let n=await fetch("/api/genereaza/".concat(a),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,format:a})}),r=await n.blob(),i=URL.createObjectURL(r),o="document.".concat(a),c={from:"bot",text:'Document generat: <a href="'.concat(i,'" download="').concat(o,'">Descarcă ').concat(o,"</a>")};t(e=>[...e,c])}else if(l){let n=l.name.toLowerCase().split(".").pop(),a=["pdf","xlsx","docx","txt"].includes(n||"")?"/api/proceseaza-upload/".concat(n):"/api/proceseaza-upload",r=new FormData;r.append("file",l),r.append("prompt",e);let i=await fetch(a,{method:"POST",body:r}),o=i.headers.get("Content-Type")||"";if(o.startsWith("application/json")){let e=await i.json(),n={from:"bot",text:e.reply||"Fără răspuns."};t(e=>[...e,n])}else{let e=await i.blob(),n=URL.createObjectURL(e),a=i.headers.get("X-Filename")||l.name,r={from:"bot",text:'Document generat: <a href="'.concat(n,'" download="').concat(a,'">Descarcă ').concat(a,"</a>")};t(e=>[...e,r])}d(null)}else{let a=n.includes("client")||n.includes("proiect")||n.includes("factură")||n.includes("facturi")||n.includes("contract")||n.includes("contracte")||n.includes("tranzacți")||n.includes("bancă")||n.includes("subproiect")||n.includes("adaugă")||n.includes("actualizează")||n.includes("șterge")||n.includes("caută")||n.includes("tabele")||n.includes("baza de date")||n.includes("bigquery")||n.includes("c\xe2te")||n.includes("arată")||n.includes("lista")||n.includes("toate")||n.includes("structura")||n.includes("schema")||n.includes("inserează")||n.includes("selectează")||n.includes("panoucontrolunitar")||n.includes("dataset")||n.includes("bancatranzactii")||n.includes("emise")||n.includes("primite")||n.includes("suma")||n.includes("buget")||n.includes("total")||n.includes("raport")||n.includes("statistici")||n.includes("confirm")||n.includes("execută");if(a){let n=await fetch("/api/ai-database",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e})}),a=await n.json();if(a.success){let e={from:"bot",text:a.reply||"Fără răspuns."};t(t=>[...t,e])}else{let n=await fetch("/api/queryOpenAI",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),a=await n.json(),r={from:"bot",text:a.reply||"Fără răspuns."};t(e=>[...e,r])}}else{let n=await fetch("/api/queryOpenAI",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),a=await n.json(),r={from:"bot",text:a.reply||"Fără răspuns."};t(e=>[...e,r])}}}catch(e){console.error("Eroare chatbot:",e),t(e=>[...e,{from:"bot",text:"Eroare la conectare cu serverul."}])}s(!1)},f=(0,r.useCallback)(e=>{let n=e[0];n&&(d(n),t(e=>[...e,{from:"user",text:"Am \xeencărcat fișierul: ".concat(n.name)}]))},[]),{getRootProps:x,getInputProps:b,isDragActive:h}=(0,i.uI)({onDrop:f});return(0,r.useEffect)(()=>{var e;null===(e=u.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),(0,a.jsxs)("div",{style:{position:"fixed",bottom:"10px",right:"10px",width:"340px",background:"#fefefe",border:"1px solid #ccc",borderRadius:"8px",zIndex:9999,boxShadow:"0 0 10px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",maxHeight:"90vh"},children:[(0,a.jsx)("div",{style:{background:"#4caf50",color:"white",padding:"10px",textAlign:"center",fontWeight:"bold",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:"Asistent AI"}),(0,a.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"10px",paddingBottom:"0"},children:[e.map((e,t)=>(0,a.jsx)("div",{style:{textAlign:"user"===e.from?"right":"left",margin:"5px 0"},children:(0,a.jsx)("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:"12px",background:"user"===e.from?"#dcf8c6":"#e0e0e0",maxWidth:"90%",wordWrap:"break-word"},children:e.text.startsWith("Document generat")?(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:e.text}}):e.text})},t)),(0,a.jsx)("div",{ref:u})]}),(0,a.jsxs)("div",{style:{padding:"10px",borderTop:"1px solid #ccc"},children:[(0,a.jsx)("textarea",{rows:3,value:n,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),p())},placeholder:"Scrie un mesaj... (Ctrl+Enter pentru a trimite)",style:{width:"100%",resize:"none",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px"}}),(0,a.jsxs)("div",{...x(),style:{border:"2px dashed #aaa",padding:"6px",textAlign:"center",marginTop:"6px",cursor:"pointer",borderRadius:"6px",background:h?"#eee":"#fafafa"},children:[(0,a.jsx)("input",{...b()}),h?"Lasa fișierele aici...":"\xcencarcă fișier"]}),(0,a.jsx)("button",{onClick:p,disabled:c,style:{marginTop:"8px",width:"100%",padding:"8px",background:"#4caf50",color:"white",border:"none",borderRadius:"6px",cursor:c?"not-allowed":"pointer"},children:c?"Se generează...":"Trimite"})]})]})}},44:function(e,t,n){function a(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)0>t.indexOf(a[r])&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n}function r(e,t,n,a){return new(n||(n=Promise))(function(r,i){function o(e){try{s(a.next(e))}catch(e){i(e)}}function c(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,c)}s((a=a.apply(e,t||[])).next())})}n.d(t,{_T:function(){return a},mG:function(){return r}}),"function"==typeof SuppressedError&&SuppressedError}}]);