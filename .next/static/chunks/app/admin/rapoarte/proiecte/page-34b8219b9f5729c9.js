(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{9530:function(e,t,r){Promise.resolve().then(r.bind(r,9883))},9883:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return S}});var a=r(6705),i=r(428),o=r.n(i),n=r(955),l=r(4033);function s(e){let{filters:t,values:r,onChange:i,onReset:o,loading:l=!1}=e,[s,d]=(0,n.useState)(!1),c=(e,t)=>{i({...r,[e]:t})},p=Object.values(r).some(e=>""!==e&&null!=e);return(0,a.jsxs)("div",{style:{background:"white",borderRadius:"8px",padding:"1.5rem",marginBottom:"1.5rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid #dee2e6"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:s?"1.5rem":"0"},children:[(0,a.jsxs)("h3",{style:{margin:0,color:"#2c3e50",display:"flex",alignItems:"center",gap:"0.5rem"},children:["\uD83D\uDD0D Filtre și Căutare",p&&(0,a.jsx)("span",{style:{background:"#007bff",color:"white",borderRadius:"12px",padding:"2px 8px",fontSize:"12px",fontWeight:"normal"},children:Object.values(r).filter(e=>""!==e&&null!=e).length})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[p&&(0,a.jsx)("button",{onClick:o,disabled:l,style:{padding:"0.5rem 1rem",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontSize:"14px",opacity:l?.6:1},children:"\uD83D\uDD04 Reset"}),(0,a.jsx)("button",{onClick:()=>d(!s),style:{padding:"0.5rem 1rem",background:"transparent",color:"#007bff",border:"1px solid #007bff",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:s?"Ascunde ↑":"Extinde ↓"})]})]}),s&&(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",alignItems:"end"},children:t.map(e=>{var t;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#495057",fontSize:"14px",fontWeight:500},children:e.label}),"text"===e.type&&(0,a.jsx)("input",{type:"text",value:r[e.key]||"",onChange:t=>c(e.key,t.target.value),placeholder:e.placeholder,disabled:l,style:{width:"100%",padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}}),"select"===e.type&&(0,a.jsxs)("select",{value:r[e.key]||"",onChange:t=>c(e.key,t.target.value),disabled:l,style:{width:"100%",padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",background:"white",opacity:l?.6:1},children:[(0,a.jsx)("option",{value:"",children:e.placeholder||"Selectează..."}),null===(t=e.options)||void 0===t?void 0:t.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),"date"===e.type&&(0,a.jsx)("input",{type:"date",value:r[e.key]||"",onChange:t=>c(e.key,t.target.value),disabled:l,style:{width:"100%",padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}}),"dateRange"===e.type&&(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,a.jsx)("input",{type:"date",value:r["".concat(e.key,"_start")]||"",onChange:t=>c("".concat(e.key,"_start"),t.target.value),disabled:l,style:{flex:1,padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}}),(0,a.jsx)("span",{style:{alignSelf:"center",color:"#6c757d"},children:"→"}),(0,a.jsx)("input",{type:"date",value:r["".concat(e.key,"_end")]||"",onChange:t=>c("".concat(e.key,"_end"),t.target.value),disabled:l,style:{flex:1,padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}})]})]},e.key)})})]})}function d(e){let{values:t,onChange:r,onReset:i,loading:o=!1}=e;return(0,a.jsx)(s,{filters:[{key:"search",label:"Căutare generală",type:"text",placeholder:"Caută după nume proiect, client, ID..."},{key:"status",label:"Status proiect",type:"select",placeholder:"Toate statusurile",options:[{value:"Activ",label:"\uD83D\uDFE2 Activ"},{value:"\xcen lucru",label:"\uD83D\uDFE1 \xcen lucru"},{value:"Suspendat",label:"\uD83D\uDFE0 Suspendat"},{value:"Finalizat",label:"✅ Finalizat"},{value:"Anulat",label:"\uD83D\uDD34 Anulat"}]},{key:"client",label:"Client",type:"select",placeholder:"Toți clienții",options:[{value:"SC T&D PRO ELECTRIC SRL",label:"SC T&D PRO ELECTRIC SRL"},{value:"SC PROD SRL",label:"SC PROD SRL"},{value:"SC BUILD SRL",label:"SC BUILD SRL"}]},{key:"data_start",label:"Perioada \xeenceput",type:"dateRange",placeholder:"Data \xeenceput"},{key:"valoare_min",label:"Valoare minimă (RON)",type:"text",placeholder:"0"},{key:"valoare_max",label:"Valoare maximă (RON)",type:"text",placeholder:"999999"}],values:t,onChange:r,onReset:i,loading:o})}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #ffffff;\n    color: ".concat("success"===t?"#27ae60":"error"===t?"#e74c3c":"#3498db",";\n    padding: 16px 20px;\n    border-radius: 12px;\n    z-index: 16000;\n    font-family: 'Inter', Arial, sans-serif;\n    font-size: 14px;\n    font-weight: 500;\n    box-shadow: 0 15px 30px rgba(0,0,0,0.2);\n    border: 1px solid #e0e0e0;\n    max-width: 400px;\n    word-wrap: break-word;\n    transform: translateY(-10px);\n    opacity: 0;\n    transition: all 0.3s ease;\n  "),r.textContent=e,document.body.appendChild(r),setTimeout(()=>{r.style.transform="translateY(0)",r.style.opacity="1"},10),setTimeout(()=>{r.style.transform="translateY(-10px)",r.style.opacity="0",setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},300)},"success"===t||"error"===t?4e3:6e3)};function p(e){let{proiect:t,onClose:r,onSuccess:i}=e,[o,l]=(0,n.useState)([{denumire:t.Denumire,cantitate:1,pretUnitar:t.Valoare_Estimata||0,cotaTva:19,tip:"proiect"}]),[s,d]=(0,n.useState)(""),[p,u]=(0,n.useState)(null),[x,b]=(0,n.useState)(!1),[g,m]=(0,n.useState)(!1),[f,h]=(0,n.useState)(!1),[y,j]=(0,n.useState)(!1),[D,v]=(0,n.useState)(""),[S,w]=(0,n.useState)(null),[C,k]=(0,n.useState)(!1),[z,R]=(0,n.useState)([]),[T,I]=(0,n.useState)(!1),_=e=>{if(!e)return"";let t="string"==typeof e?e:e.value;try{return new Date(t).toLocaleDateString("ro-RO")}catch(e){return""}};(0,n.useEffect)(()=>{A(),E()},[t]);let A=async()=>{if(t.Client){h(!0);try{let e=await fetch("/api/rapoarte/clienti?search=".concat(encodeURIComponent(t.Client))),r=await e.json();if(r.success&&r.data&&r.data.length>0){let e=r.data[0];u({id:e.id,denumire:e.nume,cui:e.cui||"",nrRegCom:e.nr_reg_com||"",adresa:e.adresa||"",judet:e.judet,localitate:e.oras,telefon:e.telefon,email:e.email}),e.cui&&v(e.cui),c("✅ Date client preluate din BD: ".concat(e.nume),"success")}else u({denumire:t.Client,cui:"",nrRegCom:"",adresa:""}),c('ℹ️ Client "'.concat(t.Client,'" nu găsit \xeen BD. Completează manual datele.'),"info")}catch(e){console.error("Eroare la \xeencărcarea clientului din BD:",e),u({denumire:t.Client,cui:"",nrRegCom:"",adresa:""}),c("⚠️ Nu s-au putut prelua datele clientului din BD","error")}finally{h(!1)}}},E=async()=>{j(!0);try{let e=await fetch("/api/rapoarte/subproiecte?proiect_id=".concat(encodeURIComponent(t.ID_Proiect))),r=await e.json();if(r.success&&r.data){let e=r.data.map(e=>({ID_Subproiect:e.ID_Subproiect,Denumire:e.Denumire,Valoare_Estimata:e.Valoare_Estimata,Status:e.Status,adaugat:!1}));R(e),e.length>0&&c("\uD83D\uDCCB Găsite ".concat(e.length," subproiecte disponibile pentru factură"),"info")}}catch(e){console.error("Eroare la \xeencărcarea subproiectelor:",e),c("⚠️ Nu s-au putut \xeencărca subproiectele","error")}finally{j(!1)}},W=e=>{if(o.length>1){let t=o[e];"subproiect"===t.tip&&t.subproiect_id&&R(e=>e.map(e=>e.ID_Subproiect===t.subproiect_id?{...e,adaugat:!1}:e)),l(o.filter((t,r)=>r!==e))}},B=(e,t,r)=>{let a=[...o];a[e]={...a[e],[t]:r},l(a)},F=e=>{let t={denumire:"".concat(e.Denumire," (Subproiect)"),cantitate:1,pretUnitar:e.Valoare_Estimata||0,cotaTva:19,tip:"subproiect",subproiect_id:e.ID_Subproiect};l(e=>[...e,t]),R(t=>t.map(t=>t.ID_Subproiect===e.ID_Subproiect?{...t,adaugat:!0}:t)),c('✅ Subproiect "'.concat(e.Denumire,'" adăugat la factură'),"success")},P=async()=>{if(!D.trim()){c("Introduceți CUI-ul clientului","error");return}m(!0),w(null);try{let e=await fetch("/api/anaf/company-info?cui=".concat(encodeURIComponent(D))),t=await e.json();if(t.success){let e=t.data;u({...p,denumire:e.denumire,cui:e.cui,nrRegCom:e.nrRegCom,adresa:e.adresa,judet:e.judet,localitate:e.localitate,telefon:e.telefon,status:e.status,platitorTva:e.platitorTva}),c("✅ Datele au fost actualizate cu informațiile de la ANAF!","success"),"Inactiv"===e.status&&c("⚠️ Atenție: Compania este inactivă conform ANAF!","error"),"Nu"===e.platitorTva&&c("ℹ️ Compania nu este plătitoare de TVA","info")}else w(t.error),c("❌ ".concat(t.error),"error")}catch(t){let e="Eroare la comunicarea cu ANAF";w(e),c(e,"error")}finally{m(!1)}},O=()=>new Promise((e,t)=>{if(window.jsPDF&&window.html2canvas){e();return}let r=document.createElement("script");r.src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js",r.onload=()=>{window.jsPDF=window.jspdf.jsPDF;let r=document.createElement("script");r.src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js",r.onload=()=>{window.html2canvas=window.html2canvas,e()},r.onerror=t,document.head.appendChild(r)},r.onerror=t,document.head.appendChild(r)}),N=async(e,t)=>{try{k(!0),c("\uD83D\uDD04 Se procesează HTML-ul \xeen PDF...","info"),await O();let r=document.createElement("div");r.id="pdf-content",r.style.position="fixed",r.style.left="0px",r.style.top="0px",r.style.width="794px",r.style.height="1000px",r.style.backgroundColor="white",r.style.fontFamily="Arial, sans-serif",r.style.fontSize="4px",r.style.color="#333",r.style.lineHeight="1.0",r.style.padding="15px",r.style.zIndex="-1000",r.style.opacity="1",r.style.transform="scale(1)",r.style.overflow="hidden",r.style.boxSizing="border-box",r.style.display="flex",r.style.flexDirection="column",r.style.justifyContent="space-between";let a=new DOMParser,o=a.parseFromString(e,"text/html"),n=o.querySelector("style"),l=n&&n.textContent||"",s=o.body;if(s){r.innerHTML=s.innerHTML;let e=document.createElement("style");e.id="pdf-styles",e.textContent=l,document.getElementById("pdf-styles")||document.head.appendChild(e)}else r.innerHTML=e;document.body.appendChild(r),await new Promise(e=>setTimeout(e,1e3));let d=new window.jsPDF("p","pt","a4"),p=d.internal.pageSize.getWidth(),u=document.getElementById("pdf-content");await d.html(u||r,{callback:function(e){document.body.removeChild(r);let a=document.getElementById("pdf-styles");a&&document.head.removeChild(a),e.save(t),c("✅ PDF generat și descărcat cu succes!","success"),i(t.replace(".pdf",""),""),k(!1)},margin:[10,10,10,10],width:p-20,windowWidth:p-20,autoPaging:"text",html2canvas:{allowTaint:!0,dpi:96,letterRendering:!0,logging:!1,scale:.75,useCORS:!0,backgroundColor:"#ffffff",height:1e3,width:p-20,scrollX:0,scrollY:0,windowWidth:p-20,windowHeight:1e3,onclone:e=>{let t=e.getElementById("pdf-content");if(t){let r;let a=t.querySelectorAll("*");a.forEach(e=>{e.style.fontSize="3px",e.style.lineHeight="0.8",e.style.margin="0.25px",e.style.padding="0.25px",e.style.marginTop="0.25px",e.style.marginBottom="0.25px",e.style.paddingTop="0.25px",e.style.paddingBottom="0.25px"});let i=t.querySelectorAll("h1, h2, h3, h4, .header h1");i.forEach(e=>{e.style.fontSize="4px",e.style.margin="0.5px 0",e.style.padding="0.5px 0",e.style.fontWeight="bold"});let o=t.querySelectorAll(".invoice-number");o.forEach(e=>{e.style.fontSize="6px",e.style.margin="1px 0",e.style.fontWeight="bold"});let n=t.querySelectorAll("table, th, td");n.forEach(e=>{e.style.fontSize="2.5px",e.style.padding="0.25px",e.style.margin="0",e.style.borderSpacing="0",e.style.borderCollapse="collapse",e.style.lineHeight="0.8"});let l=t.querySelectorAll("div");l.forEach(e=>{e.style.margin="0.25px 0",e.style.padding="0.25px"});let s=t.querySelectorAll("p, span, .info-line, strong");s.forEach(e=>{e.style.fontSize="3px",e.style.lineHeight="0.8",e.style.margin="0.25px 0",e.style.padding="0.25px 0"});let d=e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1);for(;r=d.nextNode();){let t=r,a=e.defaultView.getComputedStyle(t),i=parseFloat(a.fontSize);i>4&&(t.style.fontSize="3px !important",t.style.setProperty("font-size","3px","important")),parseFloat(a.marginTop)>2&&(t.style.marginTop="0.5px !important"),parseFloat(a.marginBottom)>2&&(t.style.marginBottom="0.5px !important"),parseFloat(a.paddingTop)>2&&(t.style.paddingTop="0.25px !important"),parseFloat(a.paddingBottom)>2&&(t.style.paddingBottom="0.25px !important")}t.style.fontSize="3px !important",t.style.lineHeight="0.8 !important",t.style.padding="5px !important",t.style.margin="0 !important"}}}})}catch(e){k(!1),console.error("❌ PDF processing error:",e),c("❌ Eroare la generarea PDF: ".concat(e instanceof Error?e.message:"Eroare necunoscută"),"error")}},V=async()=>{if(!(null==p?void 0:p.cui)){c("CUI-ul clientului este obligatoriu","error");return}if(o.some(e=>!e.denumire.trim()||e.pretUnitar<=0)){c("Toate liniile trebuie să aibă denumire și preț valid","error");return}if(!p.denumire.trim()){c("Denumirea clientului este obligatorie","error");return}b(!0);try{c("\uD83D\uDD04 Se generează template-ul facturii...","info");let e=await fetch("/api/actions/invoices/generate-hibrid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({proiectId:t.ID_Proiect,liniiFactura:o,observatii:s,clientInfo:p})}),r=await e.json();if(r.success&&r.htmlContent)c("✅ Template generat! Se procesează PDF-ul...","success"),await N(r.htmlContent,r.fileName);else throw Error(r.error||"Eroare la generarea template-ului")}catch(e){c("❌ Eroare: ".concat(e instanceof Error?e.message:"Eroare necunoscută"),"error"),b(!1)}finally{C||b(!1)}},L=(()=>{let e=0,t=0;o.forEach(r=>{let a=Number(r.cantitate)||0,i=Number(r.pretUnitar)||0,o=Number(r.cotaTva)||0,n=a*i;e+=n,t+=n*(o/100)});let r=e=>(Number(e)||0).toFixed(2);return{subtotal:r(e),totalTva:r(t),totalGeneral:r(e+t)}})(),M=x||C;return(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:(0,a.jsxs)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)",maxWidth:"1000px",width:"100%",maxHeight:"90vh",overflowY:"auto"},children:[(0,a.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #dee2e6",background:"#f8f9fa",borderRadius:"8px 8px 0 0"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)("h2",{style:{margin:0,color:"#2c3e50"},children:"\uD83D\uDCB0 Generare Factură Hibridă"}),(0,a.jsx)("button",{onClick:r,disabled:M,style:{background:"transparent",border:"none",fontSize:"24px",cursor:M?"not-allowed":"pointer",color:"#6c757d"},children:"\xd7"})]}),(0,a.jsxs)("p",{style:{margin:"0.5rem 0 0 0",color:"#7f8c8d",fontSize:"14px"},children:["\uD83D\uDCCA Auto-completare client din BD + selector subproiecte • Proiect: ",(0,a.jsx)("span",{style:{fontFamily:"monospace",fontWeight:"600",color:"#3498db"},children:t.ID_Proiect})]})]}),(0,a.jsxs)("div",{style:{padding:"1.5rem"},children:[M&&(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsxs)("div",{style:{background:"white",padding:"2rem",borderRadius:"8px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)",textAlign:"center"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"18px",fontWeight:"600",color:"#2c3e50"},children:[(0,a.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",border:"3px solid #3498db",borderTop:"3px solid transparent",animation:"spin 1s linear infinite"}}),(0,a.jsxs)("span",{children:[x&&!C&&"\uD83D\uDD04 Se generează template-ul...",C&&"\uD83D\uDCC4 Se procesează PDF-ul cu date din BD..."]})]}),(0,a.jsx)("style",{children:"\n                    @keyframes spin {\n                      0% { transform: rotate(0deg); }\n                      100% { transform: rotate(360deg); }\n                    }\n                  "})]})}),(0,a.jsxs)("div",{style:{background:"#f8f9fa",padding:"1rem",borderRadius:"6px",border:"1px solid #dee2e6",marginBottom:"1rem"},children:[(0,a.jsx)("h3",{style:{fontSize:"16px",fontWeight:"bold",color:"#2c3e50",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"\uD83C\uDFD7️ Informații Proiect"}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"ID Proiect"}),(0,a.jsx)("div",{style:{padding:"0.75rem",background:"white",border:"1px solid #dee2e6",borderRadius:"6px",fontFamily:"monospace",fontWeight:"bold"},children:t.ID_Proiect})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Status"}),(0,a.jsx)("div",{style:{padding:"0.75rem",background:"white",border:"1px solid #dee2e6",borderRadius:"6px",color:"#27ae60",fontWeight:"bold"},children:t.Status})]}),(0,a.jsxs)("div",{style:{gridColumn:"span 2"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Denumire"}),(0,a.jsx)("div",{style:{padding:"0.75rem",background:"white",border:"1px solid #dee2e6",borderRadius:"6px"},children:t.Denumire})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Valoare Estimată"}),(0,a.jsx)("div",{style:{padding:"0.75rem",background:"white",border:"1px solid #dee2e6",borderRadius:"6px",color:"#27ae60",fontWeight:"bold"},children:t.Valoare_Estimata?"".concat((Number(t.Valoare_Estimata)||0).toLocaleString("ro-RO")," RON"):"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Perioada"}),(0,a.jsxs)("div",{style:{padding:"0.75rem",background:"white",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"},children:[_(t.Data_Start)," → ",_(t.Data_Final)]})]})]}),z.length>0&&(0,a.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,a.jsxs)("h4",{style:{margin:0,color:"#2c3e50"},children:["\uD83D\uDCCB Subproiecte Disponibile (",z.length,")"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>I(!T),disabled:M,style:{padding:"0.5rem 1rem",background:"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:M?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold"},children:[T?"\uD83D\uDC41️ Ascunde":"\uD83D\uDC40 Afișează"," Lista"]})]}),T&&(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"0.5rem",maxHeight:"200px",overflowY:"auto"},children:z.map(e=>(0,a.jsx)("div",{style:{border:"1px solid #dee2e6",borderRadius:"6px",padding:"1rem",background:e.adaugat?"#d4edda":"white"},children:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,a.jsxs)("div",{style:{flex:1},children:[(0,a.jsxs)("div",{style:{fontWeight:"bold",color:"#2c3e50",marginBottom:"0.5rem"},children:["\uD83D\uDCCB ",e.Denumire]}),(0,a.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d"},children:["\uD83D\uDCB0 Valoare: ",(0,a.jsx)("span",{style:{fontWeight:"bold",color:"#27ae60"},children:e.Valoare_Estimata?"".concat(e.Valoare_Estimata.toLocaleString("ro-RO")," RON"):"Fără valoare"})]}),(0,a.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d"},children:["\uD83D\uDCCA Status: ",(0,a.jsx)("span",{style:{fontWeight:"bold"},children:e.Status})]})]}),(0,a.jsx)("button",{onClick:()=>F(e),disabled:e.adaugat||M,style:{marginLeft:"1rem",padding:"0.5rem 1rem",background:e.adaugat?"#27ae60":"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:e.adaugat||M?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold"},children:e.adaugat?"✓ Adăugat":"+ Adaugă"})]})},e.ID_Subproiect))})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,a.jsxs)("h3",{style:{margin:0,color:"#2c3e50"},children:["\uD83D\uDC64 Informații Client",f&&(0,a.jsx)("span",{style:{fontSize:"12px",color:"#3498db",fontWeight:"500"},children:" ⏳ Se \xeencarcă din BD..."})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,a.jsx)("input",{type:"text",value:D,onChange:e=>v(e.target.value),disabled:M,placeholder:"Introduceți CUI (ex: RO12345678)",style:{padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px",width:"200px"}}),(0,a.jsx)("button",{onClick:P,disabled:g||!D.trim()||M,style:{padding:"0.75rem 1rem",background:g||!D.trim()||M?"#bdc3c7":"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:g||!D.trim()||M?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",whiteSpace:"nowrap"},children:g?"⏳ Se preiau...":"\uD83D\uDCE1 Preluare ANAF"})]})]}),S&&(0,a.jsxs)("div",{style:{background:"#f8d7da",border:"1px solid #f5c6cb",borderRadius:"6px",padding:"0.75rem",marginBottom:"1rem",fontSize:"14px",color:"#721c24"},children:["❌ ",S]}),p&&(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Denumire *"}),(0,a.jsx)("input",{type:"text",value:p.denumire,onChange:e=>u({...p,denumire:e.target.value}),disabled:M,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"},required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"CUI *"}),(0,a.jsx)("input",{type:"text",value:p.cui,onChange:e=>u({...p,cui:e.target.value}),disabled:M,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"},required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Nr. Reg. Com."}),(0,a.jsx)("input",{type:"text",value:p.nrRegCom,onChange:e=>u({...p,nrRegCom:e.target.value}),disabled:M,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Telefon"}),(0,a.jsx)("input",{type:"text",value:p.telefon||"",onChange:e=>u({...p,telefon:e.target.value}),disabled:M,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,a.jsxs)("div",{style:{gridColumn:"span 2"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Adresa *"}),(0,a.jsx)("input",{type:"text",value:p.adresa,onChange:e=>u({...p,adresa:e.target.value}),disabled:M,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"},required:!0})]}),(p.status||p.platitorTva)&&(0,a.jsxs)("div",{style:{gridColumn:"span 2",display:"flex",gap:"1rem",marginTop:"0.5rem"},children:[p.status&&(0,a.jsxs)("span",{style:{padding:"0.5rem 1rem",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",background:"Activ"===p.status?"#d4edda":"#f8d7da",color:"Activ"===p.status?"#155724":"#721c24"},children:["Status ANAF: ",p.status]}),p.platitorTva&&(0,a.jsxs)("span",{style:{padding:"0.5rem 1rem",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",background:"Da"===p.platitorTva?"#cce7ff":"#fff3cd",color:"Da"===p.platitorTva?"#004085":"#856404"},children:["TVA: ",p.platitorTva]})]}),p.id&&(0,a.jsx)("div",{style:{gridColumn:"span 2"},children:(0,a.jsxs)("div",{style:{background:"#d4edda",border:"1px solid #c3e6cb",borderRadius:"6px",padding:"0.75rem",fontSize:"12px"},children:["✅ ",(0,a.jsx)("strong",{children:"Date preluate din BD:"})," Client ID ",p.id]})})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,a.jsx)("h3",{style:{margin:0,color:"#2c3e50"},children:"\uD83D\uDCCB Servicii/Produse"}),(0,a.jsx)("button",{onClick:()=>{l([...o,{denumire:"",cantitate:1,pretUnitar:0,cotaTva:19}])},disabled:M,style:{padding:"0.5rem 1rem",background:"#27ae60",color:"white",border:"none",borderRadius:"6px",cursor:M?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold"},children:"+ Adaugă linie"})]}),(0,a.jsx)("div",{style:{overflowX:"auto"},children:(0,a.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{background:"#f8f9fa"},children:[(0,a.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"0.75rem",textAlign:"left",fontWeight:"bold",color:"#2c3e50"},children:"Denumire serviciu/produs *"}),(0,a.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"0.75rem",textAlign:"center",width:"80px",fontWeight:"bold",color:"#2c3e50"},children:"Cant."}),(0,a.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"0.75rem",textAlign:"center",width:"120px",fontWeight:"bold",color:"#2c3e50"},children:"Preț unit. (RON)"}),(0,a.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"0.75rem",textAlign:"center",width:"80px",fontWeight:"bold",color:"#2c3e50"},children:"TVA %"}),(0,a.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"0.75rem",textAlign:"center",width:"120px",fontWeight:"bold",color:"#2c3e50"},children:"Total (RON)"}),(0,a.jsx)("th",{style:{border:"1px solid #dee2e6",padding:"0.75rem",textAlign:"center",width:"60px",fontWeight:"bold",color:"#2c3e50"},children:"Acț."})]})}),(0,a.jsx)("tbody",{children:o.map((e,t)=>{let r=Number(e.cantitate)||0,i=Number(e.pretUnitar)||0,n=Number(e.cotaTva)||0,l=r*i;return(0,a.jsxs)("tr",{style:{background:"subproiect"===e.tip?"#f0f8ff":t%2==0?"white":"#f8f9fa"},children:[(0,a.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"0.5rem"},children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:["subproiect"===e.tip&&(0,a.jsx)("span",{style:{background:"#3498db",color:"white",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"10px",fontWeight:"bold"},children:"SUB"}),(0,a.jsx)("input",{type:"text",value:e.denumire,onChange:e=>B(t,"denumire",e.target.value),disabled:M,style:{flex:1,padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"14px"},placeholder:"Descrierea serviciului sau produsului...",required:!0})]})}),(0,a.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"0.5rem"},children:(0,a.jsx)("input",{type:"number",value:e.cantitate,onChange:e=>B(t,"cantitate",parseFloat(e.target.value)||0),disabled:M,style:{width:"100%",padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",textAlign:"center",fontSize:"14px"},min:"0",step:"0.01"})}),(0,a.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"0.5rem"},children:(0,a.jsx)("input",{type:"number",value:e.pretUnitar,onChange:e=>B(t,"pretUnitar",parseFloat(e.target.value)||0),disabled:M,style:{width:"100%",padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",textAlign:"right",fontSize:"14px"},min:"0",step:"0.01"})}),(0,a.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"0.5rem"},children:(0,a.jsxs)("select",{value:e.cotaTva,onChange:e=>B(t,"cotaTva",parseFloat(e.target.value)),disabled:M,style:{width:"100%",padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",textAlign:"center",fontSize:"14px"},children:[(0,a.jsx)("option",{value:0,children:"0%"}),(0,a.jsx)("option",{value:5,children:"5%"}),(0,a.jsx)("option",{value:9,children:"9%"}),(0,a.jsx)("option",{value:19,children:"19%"}),(0,a.jsx)("option",{value:21,children:"21%"})]})}),(0,a.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"0.5rem",textAlign:"right",fontSize:"14px",fontWeight:"bold",color:"#27ae60"},children:(Number(l+l*(n/100))||0).toFixed(2)}),(0,a.jsx)("td",{style:{border:"1px solid #dee2e6",padding:"0.5rem",textAlign:"center"},children:(0,a.jsx)("button",{onClick:()=>W(t),disabled:1===o.length||M,style:{background:1===o.length||M?"#bdc3c7":"#e74c3c",color:"white",border:"none",borderRadius:"4px",padding:"0.5rem",cursor:1===o.length||M?"not-allowed":"pointer",fontSize:"12px"},title:"subproiect"===e.tip?"Șterge subproiectul din factură":"Șterge linia",children:"\uD83D\uDDD1️"})})]},t)})})]})})]}),(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:(0,a.jsx)("div",{style:{width:"300px",background:"#f8f9fa",padding:"1rem",borderRadius:"6px",border:"1px solid #dee2e6"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px",color:"#2c3e50"},children:[(0,a.jsx)("span",{children:"Subtotal (fără TVA):"}),(0,a.jsxs)("span",{style:{fontWeight:"bold"},children:[L.subtotal," RON"]})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"14px",color:"#2c3e50"},children:[(0,a.jsx)("span",{children:"TVA:"}),(0,a.jsxs)("span",{style:{fontWeight:"bold"},children:[L.totalTva," RON"]})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"16px",fontWeight:"bold",paddingTop:"0.5rem",borderTop:"2px solid #27ae60",color:"#27ae60"},children:[(0,a.jsx)("span",{children:"TOTAL DE PLATĂ:"}),(0,a.jsxs)("span",{children:[L.totalGeneral," RON"]})]})]})})}),(0,a.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"\uD83D\uDCDD Observații (opțional)"}),(0,a.jsx)("textarea",{value:s,onChange:e=>d(e.target.value),disabled:M,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px",resize:"vertical"},rows:2,placeholder:"Observații suplimentare pentru factură..."})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"1rem",borderTop:"1px solid #dee2e6"},children:[(0,a.jsx)("div",{style:{fontSize:"12px",color:"#7f8c8d",fontWeight:"500"},children:"ℹ️ Date client auto-completate din BD. Subproiecte disponibile pentru adăugare la factură."}),(0,a.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,a.jsx)("button",{onClick:r,disabled:M,style:{padding:"0.75rem 1.5rem",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:M?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Anulează"}),(0,a.jsx)("button",{onClick:V,disabled:M||!(null==p?void 0:p.cui)||!(null==p?void 0:p.denumire),style:{padding:"0.75rem 1.5rem",background:!M&&(null==p?void 0:p.cui)&&(null==p?void 0:p.denumire)?"#27ae60":"#bdc3c7",color:"white",border:"none",borderRadius:"6px",cursor:!M&&(null==p?void 0:p.cui)&&(null==p?void 0:p.denumire)?"pointer":"not-allowed",fontSize:"14px",fontWeight:"bold"},children:M?(0,a.jsxs)(a.Fragment,{children:["⏳ ",C?"Se generează PDF cu date BD...":"Se procesează..."]}):(0,a.jsx)(a.Fragment,{children:"\uD83D\uDCB0 Generează Factură din BD"})})]})]})]})]})})}let u=null,x=new Map,b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: rgba(255, 255, 255, 0.95);\n    backdrop-filter: blur(20px);\n    color: ".concat("success"===t?"#27ae60":"error"===t?"#e74c3c":"#3498db",";\n    padding: 16px 20px;\n    border-radius: 16px;\n    z-index: 15000;\n    font-family: 'Inter', Arial, sans-serif;\n    font-size: 14px;\n    font-weight: 500;\n    box-shadow: 0 20px 40px rgba(0,0,0,0.15);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    max-width: 400px;\n    word-wrap: break-word;\n    white-space: pre-line;\n    transform: translateY(-10px);\n    opacity: 0;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  "),r.textContent=e,document.body.appendChild(r),setTimeout(()=>{r.style.transform="translateY(0)",r.style.opacity="1"},10),setTimeout(()=>{r.style.transform="translateY(-10px)",r.style.opacity="0",setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},300)},"success"===t?4e3:"error"===t?5e3:"info"===t&&e.length>200?1e4:6e3)};function g(e){let{proiect:t,onRefresh:r}=e,[i,o]=n.useState(!1),[l,s]=n.useState(!1),d=e=>{if(!e)return"N/A";let t="string"==typeof e?e:e.value;try{return new Date(t).toLocaleDateString("ro-RO")}catch(e){return"N/A"}},c=[{key:"view",label:"Vezi Detalii",icon:"\uD83D\uDC41️",color:"primary"},{key:"edit",label:"Editează",icon:"✏️",color:"secondary"},..."subproiect"!==t.tip?[{key:"add_subproject",label:"Adaugă Subproiect",icon:"\uD83D\uDCC2",color:"success",disabled:"Anulat"===t.Status||"Arhivat"===t.Status}]:[],..."subproiect"!==t.tip?[{key:"divider1",label:"",icon:"",color:"primary",divider:!0},{key:"generate_invoice",label:"Generează Factură PDF",icon:"\uD83D\uDCB0",color:"warning",disabled:"Anulat"===t.Status}]:[],{key:"divider2",label:"",icon:"",color:"primary",divider:!0},{key:"mark_completed",label:"Marchează Finalizat",icon:"✅",color:"success",disabled:"Finalizat"===t.Status||"Anulat"===t.Status},{key:"suspend",label:"subproiect"===t.tip?"Suspendă Subproiect":"Suspendă Proiect",icon:"⏸️",color:"warning",disabled:"Suspendat"===t.Status||"Finalizat"===t.Status},{key:"divider3",label:"",icon:"",color:"primary",divider:!0},{key:"delete",label:"subproiect"===t.tip?"Șterge Subproiect":"Șterge Proiect",icon:"\uD83D\uDDD1️",color:"danger"}],u=async e=>{try{switch(e){case"view":await h();break;case"edit":await y();break;case"add_subproject":x();break;case"generate_invoice":g();break;case"mark_completed":await j("Finalizat");break;case"suspend":await j("Suspendat");break;case"delete":await D();break;default:b("Funcție \xeen dezvoltare","info")}}catch(t){console.error("Eroare la ".concat(e,":"),t),b("Eroare la executarea acțiunii: ".concat(e),"error")}},x=()=>{s(!0)},g=()=>{o(!0)},h=async()=>{let e="\uD83D\uDCCB ".concat("subproiect"===t.tip?"SUBPROIECT":"PROIECT",": ").concat(t.ID_Proiect,"\n\n\uD83D\uDCDD Denumire: ").concat(t.Denumire,"\n\uD83D\uDC64 Client: ").concat(t.Client,"\n\uD83D\uDCCA Status: ").concat(t.Status,"\n\uD83D\uDCB0 Valoare: ").concat(t.Valoare_Estimata?"".concat(t.Valoare_Estimata.toLocaleString("ro-RO")," RON"):"N/A","\n\uD83D\uDCC5 \xcencepe: ").concat(d(t.Data_Start),"\n\uD83D\uDCC5 Finalizare: ").concat(d(t.Data_Final),"\n\uD83D\uDC64 Responsabil: ").concat(t.Responsabil||"Neatribuit","\n\uD83D\uDCCD Adresă: ").concat(t.Adresa||"Nespecificată","\n\uD83D\uDCDD Observații: ").concat(t.Observatii||"Fără observații");b(e,"info"),console.log("Detalii proiect:",t)},y=async()=>{let e=confirm("Vrei să editezi ".concat("subproiect"===t.tip?"subproiectul":"proiectul",' "').concat(t.Denumire,'"?\n\nNOTĂ: Funcția de editare va fi implementată \xeen următoarea versiune.'));e&&b("Funcția de editare va fi disponibilă \xeen cur\xe2nd!","info");let r="subproiect"===t.tip?"/admin/rapoarte/subproiecte/".concat(t.ID_Proiect,"/edit"):"/admin/rapoarte/proiecte/".concat(t.ID_Proiect,"/edit");console.log("Ar trebui să redirectionez la:",r),console.log("Date pentru editare:",t)},j=async e=>{let a=confirm('Sigur vrei să schimbi statusul la "'.concat(e,'"?'));if(a)try{let a="subproiect"===t.tip?"/api/rapoarte/subproiecte":"/api/rapoarte/proiecte",i=await fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.ID_Proiect,Status:e})}),o=await i.json();o.success?(b("Status actualizat la: ".concat(e),"success"),null==r||r()):b(o.error||"Eroare la actualizarea statusului","error")}catch(e){b("Eroare la actualizarea statusului","error")}},D=async()=>{let e="subproiect"===t.tip?"subproiectul":"proiectul",a=confirm("Sigur vrei să ștergi ".concat(e," ").concat(t.ID_Proiect,"?\n\nAceastă acțiune nu poate fi anulată!"));if(a)try{let a="subproiect"===t.tip?"/api/rapoarte/subproiecte?id=".concat(encodeURIComponent(t.ID_Proiect)):"/api/rapoarte/proiecte?id=".concat(encodeURIComponent(t.ID_Proiect)),i=await fetch(a,{method:"DELETE"}),o=await i.json();o.success?(b("".concat(e.charAt(0).toUpperCase()+e.slice(1)," șters cu succes!"),"success"),null==r||r()):b(o.error||"Eroare la ștergerea ".concat(e),"error")}catch(t){b("Eroare la ștergerea ".concat(e),"error")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{actions:c,onAction:u,proiect:t}),i&&(0,a.jsx)(p,{proiect:t,onClose:()=>o(!1),onSuccess:(e,t)=>{o(!1),b("Factura ".concat(e," a fost generată cu succes!"),"success"),r&&r()}}),l&&(0,a.jsx)(m,{proiectParinte:t,onClose:()=>s(!1),onSuccess:()=>{b("✅ Subproiect adăugat cu succes!","success"),null==r||r(),b("\uD83D\uDCA1 Poți adăuga \xeencă un subproiect sau \xeenchide modalul!","info")}})]})}function m(e){let{proiectParinte:t,onClose:r,onSuccess:i}=e,[o,l]=n.useState({denumire:"",responsabil:"",dataStart:new Date().toISOString().split("T")[0],dataFinal:"",valoareEstimata:"0",status:"Activ"}),[s,d]=n.useState(!1),c=(e,t)=>{l(r=>({...r,[e]:t}))},p=()=>{l({denumire:"",responsabil:"",dataStart:new Date().toISOString().split("T")[0],dataFinal:"",valoareEstimata:"0",status:"Activ"}),b("\uD83D\uDCCB Formular resetat pentru noul subproiect!","info")},u=async e=>{if(e.preventDefault(),!o.denumire.trim()){b("Denumirea subproiectului este obligatorie","error");return}d(!0);try{let e="".concat(t.ID_Proiect,"_SUB_").concat(Date.now()),r={ID_Subproiect:e,ID_Proiect:t.ID_Proiect,Denumire:o.denumire.trim(),Responsabil:o.responsabil.trim()||null,Data_Start:o.dataStart||null,Data_Final:o.dataFinal||null,Valoare_Estimata:o.valoareEstimata?parseFloat(o.valoareEstimata):null,Status:o.status};console.log("Trimitere subproiect:",r);let a=await fetch("/api/rapoarte/subproiecte",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),n=await a.json();console.log("Răspuns subproiect:",n),n.success?(i(),p()):b(n.error||"Eroare la adăugarea subproiectului","error")}catch(e){console.error("Eroare la adăugarea subproiectului:",e),b("Eroare la adăugarea subproiectului","error")}finally{d(!1)}};return(0,a.jsx)("div",{style:{position:"fixed",inset:"0",background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3,padding:"1rem"},children:(0,a.jsxs)("div",{style:{background:"#ffffff",borderRadius:"16px",maxWidth:"600px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)",border:"1px solid #e0e0e0",position:"relative",transform:"scale(1)",opacity:1},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1.5rem",borderBottom:"1px solid #e0e0e0",background:"#e8f5e8",borderRadius:"16px 16px 0 0"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#2c3e50",margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:"\uD83D\uDCC2 Adaugă Subproiect Nou"}),(0,a.jsxs)("p",{style:{fontSize:"14px",color:"#7f8c8d",margin:"0.5rem 0 0 0",fontWeight:"500"},children:["\uD83C\uDFD7️ Proiect părinte: ",(0,a.jsx)("span",{style:{fontFamily:"monospace",fontWeight:"600",color:"#3498db"},children:t.ID_Proiect})]}),(0,a.jsx)("p",{style:{fontSize:"12px",color:"#95a5a6",margin:"0.25rem 0 0 0"},children:t.Denumire})]}),(0,a.jsx)("button",{onClick:r,disabled:s,style:{background:"rgba(231, 76, 60, 0.1)",color:"#e74c3c",border:"none",borderRadius:"12px",width:"48px",height:"48px",cursor:s?"not-allowed":"pointer",fontSize:"20px",fontWeight:"600",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:e=>{s||(e.currentTarget.style.background="rgba(231, 76, 60, 0.2)",e.currentTarget.style.transform="scale(1.05)")},onMouseOut:e=>{s||(e.currentTarget.style.background="rgba(231, 76, 60, 0.1)",e.currentTarget.style.transform="scale(1)")},children:"✕"})]}),(0,a.jsxs)("form",{onSubmit:u,style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1.25rem"},children:[(0,a.jsxs)("div",{style:{background:"#f0f8ff",padding:"1.25rem",borderRadius:"12px",border:"1px solid #cce7ff",boxShadow:"0 4px 12px rgba(52, 152, 219, 0.15)"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginBottom:"0.75rem"},children:"\uD83D\uDCDD Denumire Subproiect *"}),(0,a.jsx)("input",{type:"text",value:o.denumire,onChange:e=>c("denumire",e.target.value),style:{width:"100%",padding:"1rem",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"16px",background:"#ffffff",transition:"all 0.3s ease",boxSizing:"border-box"},placeholder:"Introduceți denumirea subproiectului...",required:!0,disabled:s,onFocus:e=>{e.currentTarget.style.border="2px solid #3498db",e.currentTarget.style.boxShadow="0 4px 12px rgba(52, 152, 219, 0.2)"},onBlur:e=>{e.currentTarget.style.border="1px solid #e0e0e0",e.currentTarget.style.boxShadow="none"}})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:[(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.1)"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginBottom:"0.75rem"},children:"\uD83D\uDC64 Responsabil"}),(0,a.jsx)("input",{type:"text",value:o.responsabil,onChange:e=>c("responsabil",e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"14px",background:"#ffffff",transition:"all 0.3s ease",boxSizing:"border-box"},placeholder:"Numele responsabilului...",disabled:s})]}),(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.1)"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginBottom:"0.75rem"},children:"\uD83D\uDCCA Status"}),(0,a.jsxs)("select",{value:o.status,onChange:e=>c("status",e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"14px",background:"#ffffff",transition:"all 0.3s ease",boxSizing:"border-box"},disabled:s,children:[(0,a.jsx)("option",{value:"Activ",children:"\uD83D\uDFE2 Activ"}),(0,a.jsx)("option",{value:"Planificat",children:"\uD83D\uDCC5 Planificat"}),(0,a.jsx)("option",{value:"Suspendat",children:"⏸️ Suspendat"}),(0,a.jsx)("option",{value:"Finalizat",children:"✅ Finalizat"})]})]}),(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.1)"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginBottom:"0.75rem"},children:"\uD83D\uDCC5 Data \xcenceput"}),(0,a.jsx)("input",{type:"date",value:o.dataStart,onChange:e=>c("dataStart",e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"14px",background:"#ffffff",transition:"all 0.3s ease",boxSizing:"border-box"},disabled:s})]}),(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.1)"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginBottom:"0.75rem"},children:"\uD83C\uDFC1 Data Finalizare"}),(0,a.jsx)("input",{type:"date",value:o.dataFinal,onChange:e=>c("dataFinal",e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"14px",background:"#ffffff",transition:"all 0.3s ease",boxSizing:"border-box"},disabled:s})]})]}),(0,a.jsxs)("div",{style:{background:"#e8f8e8",padding:"1.5rem",borderRadius:"16px",border:"1px solid #c3e6cb",boxShadow:"0 4px 12px rgba(39, 174, 96, 0.15)"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginBottom:"0.75rem"},children:"\uD83D\uDCB0 Valoare Estimată (RON)"}),(0,a.jsx)("input",{type:"number",value:o.valoareEstimata,onChange:e=>c("valoareEstimata",e.target.value),style:{width:"100%",padding:"1rem",border:"1px solid #e0e0e0",borderRadius:"12px",fontSize:"16px",background:"#ffffff",transition:"all 0.3s ease",boxSizing:"border-box"},placeholder:"0.00",min:"0",step:"0.01",disabled:s})]}),(0,a.jsxs)("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"16px",border:"1px solid #e0e0e0",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},children:[(0,a.jsx)("h4",{style:{fontSize:"16px",fontWeight:"600",color:"#2c3e50",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"\uD83C\uDFD7️ Informații Proiect Părinte"}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0"},children:[(0,a.jsx)("div",{style:{fontSize:"11px",color:"#7f8c8d",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"CLIENT"}),(0,a.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginTop:"0.25rem"},children:t.Client})]}),(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0"},children:[(0,a.jsx)("div",{style:{fontSize:"11px",color:"#7f8c8d",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"STATUS"}),(0,a.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#2c3e50",marginTop:"0.25rem"},children:t.Status})]}),(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0"},children:[(0,a.jsx)("div",{style:{fontSize:"11px",color:"#7f8c8d",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"VALOARE"}),(0,a.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#27ae60",marginTop:"0.25rem"},children:t.Valoare_Estimata?"".concat(t.Valoare_Estimata.toLocaleString("ro-RO")," RON"):"N/A"})]}),(0,a.jsxs)("div",{style:{background:"#ffffff",padding:"1rem",borderRadius:"12px",border:"1px solid #e0e0e0"},children:[(0,a.jsx)("div",{style:{fontSize:"11px",color:"#7f8c8d",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"ADRESĂ"}),(0,a.jsx)("div",{style:{fontSize:"12px",fontWeight:"500",color:"#2c3e50",marginTop:"0.25rem"},children:t.Adresa||"Nespecificată"})]})]})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",paddingTop:"1rem",borderTop:"1px solid #e0e0e0"},children:[(0,a.jsx)("button",{type:"button",onClick:r,disabled:s,style:{background:"#f8f9fa",color:"#6c757d",border:"1px solid #e0e0e0",borderRadius:"12px",padding:"0.75rem 1.5rem",fontSize:"14px",fontWeight:"600",cursor:s?"not-allowed":"pointer",transition:"all 0.3s ease"},onMouseOver:e=>{s||(e.currentTarget.style.background="#e9ecef",e.currentTarget.style.transform="translateY(-2px)")},onMouseOut:e=>{s||(e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.transform="translateY(0)")},children:"✕ \xcenchide"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,a.jsx)("button",{type:"submit",disabled:s||!o.denumire.trim(),style:{background:s||!o.denumire.trim()?"#f8f9fa":"linear-gradient(135deg, #3498db 0%, #5dade2 100%)",color:s||!o.denumire.trim()?"#6c757d":"white",border:"none",borderRadius:"12px",padding:"0.75rem 1.5rem",fontSize:"14px",fontWeight:"600",cursor:s||!o.denumire.trim()?"not-allowed":"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem",boxShadow:s||!o.denumire.trim()?"none":"0 4px 12px rgba(52, 152, 219, 0.4)"},onMouseOver:e=>{!s&&o.denumire.trim()&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(52, 152, 219, 0.5)")},onMouseOut:e=>{!s&&o.denumire.trim()&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(52, 152, 219, 0.4)")},children:s?(0,a.jsx)(a.Fragment,{children:"⏳ Se adaugă..."}):(0,a.jsx)(a.Fragment,{children:"\uD83D\uDCC2 Adaugă Subproiect"})}),(0,a.jsx)("button",{type:"button",onClick:p,disabled:s,style:{background:"linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)",color:"white",border:"none",borderRadius:"12px",padding:"0.75rem 1rem",fontSize:"14px",fontWeight:"600",cursor:s?"not-allowed":"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem",boxShadow:s?"none":"0 4px 12px rgba(39, 174, 96, 0.4)"},title:"Resetează formularul pentru a adăuga alt subproiect",onMouseOver:e=>{s||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(39, 174, 96, 0.5)")},onMouseOut:e=>{s||(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(39, 174, 96, 0.4)")},children:"\uD83D\uDD04 Resetează"})]})]})]})]})})}function f(e){let{actions:t,onAction:r,proiect:i}=e,[o,l]=n.useState(!1),[s,d]=n.useState(null),[c,p]=n.useState("bottom"),b=n.useRef(null),g=n.useMemo(()=>"dropdown-".concat(i.ID_Proiect,"-").concat(Math.random().toString(36).substr(2,9)),[i.ID_Proiect]);n.useEffect(()=>(x.set(g,()=>l(!1)),()=>{x.delete(g)}),[g]),n.useEffect(()=>{if(o){if(u&&u!==g){let e=x.get(u);e&&e()}return u=g,m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)}u===g&&(u=null)},[o,g]);let m=()=>{if(!b.current)return;let e=b.current.getBoundingClientRect(),t=window.innerHeight,r=t-e.bottom,a=e.top;console.log("\uD83D\uDCCF Dropdown positioning:",{spaceBelow:r,spaceAbove:a,dropdownHeight:350,buttonTop:e.top,buttonBottom:e.bottom,viewportHeight:t,dropdownId:g}),r<350&&a>350?(console.log("\uD83D\uDD3C Dropdown ".concat(g," va urca sus")),p("top")):(console.log("\uD83D\uDD3D Dropdown ".concat(g," va cobor\xee jos")),p("bottom"))},f=async e=>{if(!s){d(e),l(!1);try{await r(e)}finally{d(null)}}},h=e=>{switch(e){case"primary":return"#3498db";case"secondary":return"#95a5a6";case"success":return"#27ae60";case"warning":return"#f39c12";case"danger":return"#e74c3c";default:return"#7f8c8d"}};return(0,a.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,a.jsxs)("button",{ref:b,onClick:()=>{console.log("\uD83D\uDD18 Buton ".concat(g," apăsat, isOpen: ").concat(o)),l(!o)},disabled:null!==s,style:{background:s?"#f8f9fa":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:s?"#6c757d":"white",border:"none",borderRadius:"12px",padding:"0.5rem 1rem",cursor:s?"not-allowed":"pointer",fontSize:"14px",fontWeight:"600",boxShadow:s?"none":"0 4px 12px rgba(102, 126, 234, 0.4)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem"},onMouseOver:e=>{s||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(102, 126, 234, 0.5)")},onMouseOut:e=>{s||(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)")},children:[s?"⏳":"⚙️"," Acțiuni"]}),o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(6px)",zIndex:10998},onClick:()=>{console.log("\uD83D\uDD18 Overlay ".concat(g," clicked - closing")),l(!1)}}),(0,a.jsxs)("div",{style:{position:"absolute",..."bottom"===c?{top:"100%",marginTop:"8px"}:{bottom:"100%",marginBottom:"8px"},right:0,background:"#ffffff",opacity:1,borderRadius:"16px",minWidth:"260px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)",border:"1px solid #e0e0e0",zIndex:10999,overflow:"hidden",transform:"scale(1)"},children:[(0,a.jsxs)("div",{style:{padding:"1rem",borderBottom:"1px solid #e0e0e0",background:"#f8f9fa"},children:[(0,a.jsxs)("div",{style:{fontSize:"12px",fontWeight:"700",color:"#2c3e50",marginBottom:"0.5rem",fontFamily:"monospace"},children:[i.ID_Proiect,"subproiect"===i.tip&&(0,a.jsx)("span",{style:{marginLeft:"8px",fontSize:"10px",background:"linear-gradient(135deg, #3498db 0%, #5dade2 100%)",color:"white",padding:"2px 6px",borderRadius:"6px",fontWeight:"600"},children:"SUB"})]}),(0,a.jsxs)("div",{style:{fontSize:"11px",color:"#7f8c8d"},children:["Status: ",(0,a.jsx)("span",{style:{color:(e=>{switch(e){case"Activ":return"#27ae60";case"Finalizat":return"#3498db";case"Suspendat":return"#f39c12";case"Arhivat":return"#95a5a6";default:return"#7f8c8d"}})(i.Status),fontWeight:"600"},children:i.Status})]})]}),(0,a.jsx)("div",{style:{padding:"0.5rem 0"},children:t.map(e=>e.divider?(0,a.jsx)("div",{style:{height:"1px",background:"linear-gradient(90deg, transparent 0%, rgba(0, 0, 0, 0.08) 50%, transparent 100%)",margin:"0.5rem 0"}},e.key):(0,a.jsxs)("button",{onClick:()=>f(e.key),disabled:e.disabled||s===e.key,style:{width:"100%",padding:"0.75rem 1rem",background:"transparent",border:"none",textAlign:"left",cursor:e.disabled||s===e.key?"not-allowed":"pointer",fontSize:"14px",color:e.disabled?"#bdc3c7":"#2c3e50",display:"flex",alignItems:"center",gap:"0.75rem",opacity:e.disabled?.5:1,transition:"all 0.3s ease",fontWeight:"500"},onMouseOver:t=>{e.disabled||s===e.key||(t.currentTarget.style.background="".concat(h(e.color),"15"),t.currentTarget.style.color=h(e.color),t.currentTarget.style.transform="translateX(4px)")},onMouseOut:t=>{t.currentTarget.style.background="transparent",t.currentTarget.style.color=e.disabled?"#bdc3c7":"#2c3e50",t.currentTarget.style.transform="translateX(0)"},children:[(0,a.jsx)("span",{style:{minWidth:"20px",fontSize:"16px"},children:s===e.key?"⏳":e.icon}),(0,a.jsx)("span",{children:e.label})]},e.key))})]})]})]})}var h=r(8259),y=r(3811);function j(e){let{isOpen:t,onClose:r,onProiectAdded:i}=e,[o,l]=(0,n.useState)(!1),[s,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(!1),[u,x]=(0,n.useState)(""),[b,g]=(0,n.useState)(!1),[m,f]=(0,n.useState)({ID_Proiect:"",Denumire:"",Client:"",selectedClientId:"",Adresa:"",Descriere:"",Data_Start:"",Data_Final:"",Status:"Activ",Valoare_Estimata:"",Responsabil:"",Observatii:"",subproiecte:[]});(0,n.useEffect)(()=>{t&&(j(),f(e=>({...e,ID_Proiect:"P".concat(new Date().getFullYear()).concat(String(Date.now()).slice(-3))})))},[t]);let j=async()=>{try{let e=await fetch("/api/rapoarte/clienti"),t=await e.json();t.success&&d(t.data||[])}catch(e){console.error("Eroare la \xeencărcarea clienților:",e)}},D=async e=>{e.preventDefault(),l(!0);try{if(!m.ID_Proiect.trim()){h.Am.error("ID proiect este obligatoriu"),l(!1);return}if(!m.Denumire.trim()){h.Am.error("Denumirea proiectului este obligatorie"),l(!1);return}if(!m.Client.trim()){h.Am.error("Clientul este obligatoriu"),l(!1);return}console.log("Trimitere date proiect:",m),h.Am.info("Se adaugă proiectul...");let e={ID_Proiect:m.ID_Proiect.trim(),Denumire:m.Denumire.trim(),Client:m.Client.trim(),Adresa:m.Adresa.trim(),Descriere:m.Descriere.trim(),Data_Start:m.Data_Start||null,Data_Final:m.Data_Final||null,Status:m.Status,Valoare_Estimata:m.Valoare_Estimata?parseFloat(m.Valoare_Estimata):null,Responsabil:m.Responsabil.trim(),Observatii:m.Observatii.trim()},t=await fetch("/api/rapoarte/proiecte",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});console.log("Response status proiect:",t.status);let a=await t.json();console.log("Response data proiect:",a),a.success||t.ok?(m.subproiecte.length>0&&await v(m.ID_Proiect),h.Am.success("Proiect adăugat cu succes!"),i(),r(),S()):(console.error("Eroare API proiect:",a),h.Am.error("Eroare: ".concat(a.error||"Eroare necunoscută")))}catch(e){console.error("Eroare la adăugarea proiectului:",e),h.Am.error("Eroare la adăugarea proiectului")}finally{l(!1)}},v=async e=>{for(let t of m.subproiecte)try{let r={ID_Subproiect:"".concat(e,"_SUB_").concat(t.id),ID_Proiect:e,Denumire:t.denumire,Responsabil:t.responsabil,Status:t.status,Valoare_Estimata:t.valoare?parseFloat(t.valoare):null};await fetch("/api/rapoarte/subproiecte",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(e){console.error("Eroare la adăugarea subproiectului ".concat(t.denumire,":"),e)}},S=()=>{f({ID_Proiect:"",Denumire:"",Client:"",selectedClientId:"",Adresa:"",Descriere:"",Data_Start:"",Data_Final:"",Status:"Activ",Valoare_Estimata:"",Responsabil:"",Observatii:"",subproiecte:[]}),x("")},w=(e,t)=>{f(r=>({...r,[e]:t}))},C=e=>{x(e),f(t=>({...t,Client:e})),g(e.length>0)},k=e=>{x(e.nume),f(t=>({...t,Client:e.nume,selectedClientId:e.id})),g(!1)},z=s.filter(e=>e.nume.toLowerCase().includes(u.toLowerCase())).slice(0,5),R=e=>{f(t=>({...t,subproiecte:t.subproiecte.filter(t=>t.id!==e)}))},T=(e,t,r)=>{f(a=>({...a,subproiecte:a.subproiecte.map(a=>a.id===e?{...a,[t]:r}:a)}))};return t?(0,a.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:[(0,a.jsxs)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)",maxWidth:"900px",width:"100%",maxHeight:"90vh",overflowY:"auto"},children:[(0,a.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #dee2e6",background:"#f8f9fa",borderRadius:"8px 8px 0 0"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)("h2",{style:{margin:0,color:"#2c3e50"},children:"\uD83D\uDCCB Adaugă Proiect Nou"}),(0,a.jsx)("button",{onClick:r,disabled:o,style:{background:"transparent",border:"none",fontSize:"24px",cursor:"pointer",color:"#6c757d"},children:"\xd7"})]}),(0,a.jsx)("p",{style:{margin:"0.5rem 0 0 0",color:"#7f8c8d",fontSize:"14px"},children:"Completează informațiile pentru noul proiect și subproiectele asociate"})]}),(0,a.jsxs)("form",{onSubmit:D,style:{padding:"1.5rem"},children:[(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"ID Proiect *"}),(0,a.jsx)("input",{type:"text",value:m.ID_Proiect,onChange:e=>w("ID_Proiect",e.target.value),disabled:o,placeholder:"P202501",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px",fontFamily:"monospace",fontWeight:"bold"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Status"}),(0,a.jsxs)("select",{value:m.Status,onChange:e=>w("Status",e.target.value),disabled:o,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"},children:[(0,a.jsx)("option",{value:"Activ",children:"\uD83D\uDFE2 Activ"}),(0,a.jsx)("option",{value:"Planificat",children:"\uD83D\uDCC5 Planificat"}),(0,a.jsx)("option",{value:"Suspendat",children:"⏸️ Suspendat"})]})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Denumire Proiect *"}),(0,a.jsx)("input",{type:"text",value:m.Denumire,onChange:e=>w("Denumire",e.target.value),disabled:o,placeholder:"Numele proiectului",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem",position:"relative"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Client *"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,a.jsxs)("div",{style:{flex:1,position:"relative"},children:[(0,a.jsx)("input",{type:"text",value:u,onChange:e=>C(e.target.value),disabled:o,placeholder:"Caută client sau scrie numele...",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}}),b&&z.length>0&&(0,a.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"1px solid #dee2e6",borderTop:"none",borderRadius:"0 0 6px 6px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:z.map(e=>(0,a.jsxs)("div",{onClick:()=>k(e),style:{padding:"0.75rem",cursor:"pointer",borderBottom:"1px solid #f1f2f6",fontSize:"14px"},onMouseOver:e=>{e.currentTarget.style.background="#f8f9fa"},onMouseOut:e=>{e.currentTarget.style.background="white"},children:[(0,a.jsx)("div",{style:{fontWeight:"bold"},children:e.nume}),e.cui&&(0,a.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d"},children:["CUI: ",e.cui]})]},e.id))})]}),(0,a.jsx)("button",{type:"button",onClick:()=>p(!0),disabled:o,style:{padding:"0.75rem 1rem",background:"#27ae60",color:"white",border:"none",borderRadius:"6px",cursor:o?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",whiteSpace:"nowrap"},children:"+ Client Nou"})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Adresa Proiect"}),(0,a.jsx)("input",{type:"text",value:m.Adresa,onChange:e=>w("Adresa",e.target.value),disabled:o,placeholder:"Adresa unde se desfășoară proiectul (ex: Str. Exemplu Nr. 1, Bucuresti)",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Data \xcenceput"}),(0,a.jsx)("input",{type:"date",value:m.Data_Start,onChange:e=>w("Data_Start",e.target.value),disabled:o,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Data Finalizare"}),(0,a.jsx)("input",{type:"date",value:m.Data_Final,onChange:e=>w("Data_Final",e.target.value),disabled:o,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Valoare Estimată (RON)"}),(0,a.jsx)("input",{type:"number",value:m.Valoare_Estimata,onChange:e=>w("Valoare_Estimata",e.target.value),disabled:o,placeholder:"15000",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Responsabil"}),(0,a.jsx)("input",{type:"text",value:m.Responsabil,onChange:e=>w("Responsabil",e.target.value),disabled:o,placeholder:"Numele responsabilului de proiect",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Descriere"}),(0,a.jsx)("textarea",{value:m.Descriere,onChange:e=>w("Descriere",e.target.value),disabled:o,placeholder:"Descrierea detaliată a proiectului...",rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px",resize:"vertical"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,a.jsx)("h4",{style:{margin:0,color:"#2c3e50"},children:"\uD83D\uDCCB Subproiecte"}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e={id:Date.now().toString(),denumire:"",responsabil:"",valoare:"",status:"Planificat"};f(t=>({...t,subproiecte:[...t.subproiecte,e]}))},disabled:o,style:{padding:"0.5rem 1rem",background:"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:o?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold"},children:"+ Adaugă Subproiect"})]}),m.subproiecte.map((e,t)=>(0,a.jsxs)("div",{style:{border:"1px solid #dee2e6",borderRadius:"6px",padding:"1rem",marginBottom:"1rem",background:"#f8f9fa"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,a.jsxs)("h5",{style:{margin:0,color:"#2c3e50"},children:["Subproiect #",t+1]}),(0,a.jsx)("button",{type:"button",onClick:()=>R(e.id),disabled:o,style:{background:"#e74c3c",color:"white",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:"pointer",fontSize:"12px"},children:"\uD83D\uDDD1️"})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"0.5rem"},children:[(0,a.jsx)("input",{type:"text",value:e.denumire,onChange:t=>T(e.id,"denumire",t.target.value),disabled:o,placeholder:"Denumire subproiect",style:{padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"14px"}}),(0,a.jsx)("input",{type:"text",value:e.responsabil,onChange:t=>T(e.id,"responsabil",t.target.value),disabled:o,placeholder:"Responsabil",style:{padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"14px"}}),(0,a.jsx)("input",{type:"number",value:e.valoare,onChange:t=>T(e.id,"valoare",t.target.value),disabled:o,placeholder:"Valoare (RON)",style:{padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"14px"}}),(0,a.jsxs)("select",{value:e.status,onChange:t=>T(e.id,"status",t.target.value),disabled:o,style:{padding:"0.5rem",border:"1px solid #dee2e6",borderRadius:"4px",fontSize:"14px"},children:[(0,a.jsx)("option",{value:"Planificat",children:"\uD83D\uDCC5 Planificat"}),(0,a.jsx)("option",{value:"Activ",children:"\uD83D\uDFE2 Activ"}),(0,a.jsx)("option",{value:"Finalizat",children:"✅ Finalizat"})]})]})]},e.id))]}),(0,a.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Observații"}),(0,a.jsx)("textarea",{value:m.Observatii,onChange:e=>w("Observatii",e.target.value),disabled:o,placeholder:"Observații despre proiect...",rows:2,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px",resize:"vertical"}})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6"},children:[(0,a.jsx)("button",{type:"button",onClick:r,disabled:o,style:{padding:"0.75rem 1.5rem",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:o?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Anulează"}),(0,a.jsx)("button",{type:"submit",disabled:o,style:{padding:"0.75rem 1.5rem",background:o?"#bdc3c7":"#27ae60",color:"white",border:"none",borderRadius:"6px",cursor:o?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:o?"⏳ Se adaugă...":"\uD83D\uDCBE Adaugă Proiect"})]})]})]}),c&&(0,a.jsx)(y.Z,{isOpen:c,onClose:()=>p(!1),onClientAdded:()=>{j(),p(!1)}})]}):null}let D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: rgba(255, 255, 255, 0.95);\n    backdrop-filter: blur(12px);\n    color: ".concat("success"===t?"#27ae60":"error"===t?"#e74c3c":"#3498db",";\n    padding: 16px 20px;\n    border-radius: 16px;\n    z-index: 60000;\n    font-family: 'Inter', Arial, sans-serif;\n    font-size: 14px;\n    font-weight: 500;\n    box-shadow: 0 20px 40px rgba(0,0,0,0.15);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    max-width: 400px;\n    word-wrap: break-word;\n    transform: translateY(-10px);\n    opacity: 0;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  "),r.textContent=e,document.body.appendChild(r),setTimeout(()=>{r.style.transform="translateY(0)",r.style.opacity="1"},10),setTimeout(()=>{r.style.transform="translateY(-10px)",r.style.opacity="0",setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},300)},"success"===t||"error"===t?4e3:6e3)};function v(e){let{searchParams:t}=e,[r,i]=(0,n.useState)([]),[o,l]=(0,n.useState)([]),[s,d]=(0,n.useState)(!0),[c,p]=(0,n.useState)(0),[u,x]=(0,n.useState)(!1),[b,m]=(0,n.useState)(new Set);(0,n.useEffect)(()=>{f()},[t,c]),(0,n.useEffect)(()=>{if(r.length>0&&o.length>0){let e=r.map(e=>e.ID_Proiect).filter(e=>o.some(t=>t.ID_Proiect===e));e.length>0&&(m(new Set(e)),console.log("\uD83D\uDD0D Auto-expanded proiecte cu subproiecte:",e))}},[r,o]),(0,n.useEffect)(()=>{if((null==t?void 0:t.invoice_status)&&(null==t?void 0:t.project_id)){let e=t.invoice_status,r=t.project_id;switch(e){case"success":D("Factură creată cu succes pentru proiectul ".concat(r,"!"),"success");break;case"cancelled":D("Crearea facturii pentru proiectul ".concat(r," a fost anulată."),"info");break;default:D("Status factură pentru proiectul ".concat(r,": ").concat(e),"info")}}},[t]);let f=async()=>{try{d(!0),await Promise.all([h(),y()])}catch(e){console.error("Eroare la \xeencărcarea datelor:",e),D("Eroare de conectare la baza de date","error")}finally{d(!1)}},h=async()=>{try{let e=new URLSearchParams;t&&Object.entries(t).forEach(t=>{let[r,a]=t;a&&"invoice_status"!==r&&"project_id"!==r&&e.append(r,a)});let r=await fetch("/api/rapoarte/proiecte?".concat(e.toString()));if(!r.ok)throw Error("HTTP ".concat(r.status));let a=await r.json();if(a.success){let e=(a.data||[]).map(e=>({...e,tip:"proiect"}));i(e)}else throw Error(a.error||"Eroare la \xeencărcarea proiectelor")}catch(e){console.error("Eroare la \xeencărcarea proiectelor:",e),D("Eroare la \xeencărcarea proiectelor","error"),i([])}},y=async()=>{try{let r=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,a]=e;a&&"invoice_status"!==t&&"project_id"!==t&&r.append(t,a)}),console.log("\uD83D\uDD0D Loading subproiecte with params:",r.toString());let a=await fetch("/api/rapoarte/subproiecte?".concat(r.toString()));if(!a.ok)throw Error("HTTP ".concat(a.status));let i=await a.json();if(console.log("\uD83D\uDCCB Subproiecte API response:",i),i.success){var e;if(l(i.data||[]),console.log("✅ Subproiecte \xeencărcate:",(null===(e=i.data)||void 0===e?void 0:e.length)||0,"items"),console.log("\uD83D\uDCCA Subproiecte data:",i.data),i.data&&i.data.length>0){let e=i.data.reduce((e,t)=>(e[t.ID_Proiect]=(e[t.ID_Proiect]||0)+1,e),{});console.log("\uD83D\uDCC8 Subproiecte grupate pe proiecte:",e)}}else console.warn("⚠️ Nu s-au găsit subproiecte sau eroare:",i.error),l([])}catch(e){console.error("❌ Eroare la \xeencărcarea subproiectelor:",e),l([])}},v=()=>{p(e=>e+1),D("Date actualizate!","success")},S=e=>{m(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},w=e=>{let t=o.filter(t=>t.ID_Proiect===e);return console.log("\uD83D\uDD0D Pentru proiectul ".concat(e," găsite ").concat(t.length," subproiecte:"),t),t},C=async()=>{try{D("Se generează fișierul Excel...","info");let r=new URLSearchParams;t&&Object.entries(t).forEach(e=>{let[t,a]=e;a&&"invoice_status"!==t&&"project_id"!==t&&r.append(t,a)});let a=await fetch("/api/rapoarte/proiecte/export?".concat(r.toString()));if(a.ok){var e;let t=await a.blob(),r=window.URL.createObjectURL(t),i=document.createElement("a");i.href=r;let o=a.headers.get("Content-Disposition"),n=o?null===(e=o.split("filename=")[1])||void 0===e?void 0:e.replace(/"/g,""):"Proiecte_".concat(new Date().toISOString().split("T")[0],".xlsx");i.download=n,i.click(),window.URL.revokeObjectURL(r),D("Fișier Excel descărcat cu succes!","success")}else{let e=await a.json();D("Eroare la export: ".concat(e.error),"error")}}catch(e){console.error("Eroare la exportul Excel:",e),D("Eroare la exportul Excel","error")}},k=e=>{if(!e)return"";try{let t=new Date(e);if(isNaN(t.getTime()))return"";return t.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(e){return""}},z=e=>e||0===e?new Intl.NumberFormat("ro-RO",{style:"currency",currency:"RON"}).format(e):"",R=e=>{switch(e){case"Activ":return"#27ae60";case"Finalizat":return"#3498db";case"Suspendat":return"#f39c12";case"Arhivat":return"#95a5a6";default:return"#7f8c8d"}},T=e=>{switch(e){case"Activ":return"\uD83D\uDFE2";case"Finalizat":return"✅";case"Suspendat":return"⏸️";case"Arhivat":return"\uD83D\uDCE6";default:return"⚪"}};return s?(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",fontSize:"16px",color:"#7f8c8d",background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(8px)",borderRadius:"16px",border:"1px solid rgba(255, 255, 255, 0.3)",zIndex:1},children:"⏳ Se \xeencarcă proiectele..."}):(0,a.jsxs)("div",{style:{zIndex:1,position:"relative"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",padding:"1.5rem",background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",borderRadius:"16px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08)",zIndex:10},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{style:{margin:0,color:"#2c3e50",fontSize:"1.4rem",fontWeight:"600"},children:["\uD83D\uDCCB Proiecte găsite: ",r.length,o.length>0&&" (+ ".concat(o.length," subproiecte)")]}),(0,a.jsx)("p",{style:{margin:"0.5rem 0 0 0",fontSize:"14px",color:"#7f8c8d",opacity:.8},children:t&&Object.keys(t).length>0?"Rezultate filtrate":"Toate proiectele și subproiectele"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.75rem"},children:[(0,a.jsx)("button",{onClick:()=>x(!0),style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(39, 174, 96, 0.4)",transition:"all 0.3s ease",zIndex:11},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(39, 174, 96, 0.5)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(39, 174, 96, 0.4)"},children:"+ Proiect Nou"}),(0,a.jsx)("button",{onClick:v,style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #3498db 0%, #5dade2 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(52, 152, 219, 0.4)",transition:"all 0.3s ease",zIndex:11},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(52, 152, 219, 0.5)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(52, 152, 219, 0.4)"},children:"\uD83D\uDD04 Re\xeemprospătează"}),(0,a.jsx)("button",{onClick:C,style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #f39c12 0%, #f5b041 100%)",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(243, 156, 18, 0.4)",transition:"all 0.3s ease",zIndex:11},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(243, 156, 18, 0.5)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(243, 156, 18, 0.4)"},children:"\uD83D\uDCCA Export Excel"})]})]}),0===r.length?(0,a.jsxs)("div",{style:{textAlign:"center",padding:"3rem",background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(8px)",borderRadius:"16px",border:"2px dashed rgba(255, 255, 255, 0.4)",zIndex:1},children:[(0,a.jsx)("p",{style:{fontSize:"18px",color:"#7f8c8d",margin:0},children:"\uD83D\uDCCB Nu au fost găsite proiecte"}),(0,a.jsx)("p",{style:{fontSize:"14px",color:"#bdc3c7",margin:"0.5rem 0 0 0"},children:"Verifică filtrele aplicate sau adaugă proiecte noi."})]}):(0,a.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",borderRadius:"16px",border:"1px solid rgba(255, 255, 255, 0.3)",overflow:"visible",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08)",zIndex:10},children:[(0,a.jsx)("div",{style:{overflowX:"auto",overflowY:"visible"},children:(0,a.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{background:"rgba(248, 249, 250, 0.8)",backdropFilter:"blur(6px)",borderBottom:"1px solid rgba(0, 0, 0, 0.08)"},children:[(0,a.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"left",fontWeight:"600",color:"#2c3e50",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Proiect / Subproiect"}),(0,a.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"left",fontWeight:"600",color:"#2c3e50",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Client"}),(0,a.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"center",fontWeight:"600",color:"#2c3e50",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Status"}),(0,a.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"center",fontWeight:"600",color:"#2c3e50",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Data \xcenceput"}),(0,a.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"right",fontWeight:"600",color:"#2c3e50",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Valoare Estimată"}),(0,a.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"center",fontWeight:"600",color:"#2c3e50",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Acțiuni"})]})}),(0,a.jsx)("tbody",{children:r.map((e,t)=>{let r=w(e.ID_Proiect),i=b.has(e.ID_Proiect),o=r.length>0;return(0,a.jsxs)(n.Fragment,{children:[(0,a.jsxs)("tr",{style:{borderBottom:"1px solid rgba(0, 0, 0, 0.05)",background:t%2==0?"rgba(255, 255, 255, 0.5)":"rgba(248, 249, 250, 0.5)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.background="rgba(102, 126, 234, 0.08)",e.currentTarget.style.transform="translateX(4px)"},onMouseOut:e=>{e.currentTarget.style.background=t%2==0?"rgba(255, 255, 255, 0.5)":"rgba(248, 249, 250, 0.5)",e.currentTarget.style.transform="translateX(0)"},children:[(0,a.jsx)("td",{style:{padding:"0.75rem",color:"#2c3e50",width:"300px",minWidth:"250px"},children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem"},children:[o&&(0,a.jsx)("button",{onClick:()=>S(e.ID_Proiect),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem",fontSize:"12px",color:"#3498db",borderRadius:"4px",transition:"all 0.2s ease"},title:i?"Ascunde subproiectele":"Afișează subproiectele",onMouseOver:e=>{e.currentTarget.style.background="rgba(52, 152, 219, 0.1)"},onMouseOut:e=>{e.currentTarget.style.background="none"},children:i?"\uD83D\uDCC2":"\uD83D\uDCC1"}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsxs)("div",{style:{fontFamily:"monospace",fontWeight:"bold",fontSize:"12px",color:"#2c3e50",marginBottom:"0.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["\uD83C\uDFD7️ ",e.ID_Proiect]}),(0,a.jsx)("div",{style:{color:"#2c3e50",whiteSpace:"normal",wordBreak:"break-word",lineHeight:"1.4",fontSize:"14px",fontWeight:"500"},children:e.Denumire}),o&&(0,a.jsxs)("div",{style:{fontSize:"11px",color:"#3498db",marginTop:"0.5rem",padding:"0.25rem 0.5rem",background:"rgba(52, 152, 219, 0.1)",borderRadius:"6px",display:"inline-block"},children:["\uD83D\uDCCB ",r.length," subproiect",1!==r.length?"e":""]})]})]})}),(0,a.jsxs)("td",{style:{padding:"0.75rem",color:"#2c3e50"},children:[(0,a.jsx)("div",{style:{fontWeight:"600",fontSize:"14px"},children:e.Client}),e.Responsabil&&(0,a.jsxs)("div",{style:{fontSize:"12px",color:"#7f8c8d",marginTop:"0.25rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:["\uD83D\uDC64 ",e.Responsabil]})]}),(0,a.jsx)("td",{style:{padding:"0.75rem",textAlign:"center"},children:(0,a.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",borderRadius:"16px",fontSize:"12px",fontWeight:"600",color:"white",background:"linear-gradient(135deg, ".concat(R(e.Status)," 0%, ").concat(R(e.Status),"dd 100%)"),boxShadow:"0 2px 8px ".concat(R(e.Status),"40")},children:[T(e.Status)," ",e.Status]})}),(0,a.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",color:"#7f8c8d",fontFamily:"monospace",fontSize:"13px",fontWeight:"500"},children:k(e.Data_Start)}),(0,a.jsx)("td",{style:{padding:"0.75rem",textAlign:"right",fontWeight:"700",color:e.Valoare_Estimata?"#27ae60":"#bdc3c7",fontSize:"14px"},children:z(e.Valoare_Estimata)}),(0,a.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",zIndex:20},children:(0,a.jsx)(g,{proiect:{...e,tip:"proiect"},onRefresh:v})})]}),i&&r.map((t,r)=>(0,a.jsxs)("tr",{style:{background:"rgba(52, 152, 219, 0.05)",borderLeft:"4px solid #3498db",borderBottom:"1px solid rgba(52, 152, 219, 0.1)",transition:"all 0.3s ease"},onMouseOver:e=>{e.currentTarget.style.background="rgba(52, 152, 219, 0.1)",e.currentTarget.style.transform="translateX(8px)"},onMouseOut:e=>{e.currentTarget.style.background="rgba(52, 152, 219, 0.05)",e.currentTarget.style.transform="translateX(0)"},children:[(0,a.jsxs)("td",{style:{padding:"0.5rem 0.75rem",paddingLeft:"3rem",color:"#2c3e50"},children:[(0,a.jsxs)("div",{style:{fontFamily:"monospace",fontWeight:"bold",fontSize:"11px",color:"#3498db",marginBottom:"0.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["└─ \uD83D\uDCCB ",t.ID_Subproiect]}),(0,a.jsx)("div",{style:{color:"#2c3e50",fontStyle:"italic",fontSize:"13px",fontWeight:"500"},children:t.Denumire})]}),(0,a.jsxs)("td",{style:{padding:"0.5rem 0.75rem",color:"#2c3e50"},children:[(0,a.jsx)("div",{style:{fontSize:"13px",fontWeight:"500"},children:t.Client||e.Client}),t.Responsabil&&(0,a.jsxs)("div",{style:{fontSize:"11px",color:"#7f8c8d",marginTop:"0.25rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:["\uD83D\uDC64 ",t.Responsabil]})]}),(0,a.jsx)("td",{style:{padding:"0.5rem 0.75rem",textAlign:"center"},children:(0,a.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.3rem 0.6rem",borderRadius:"12px",fontSize:"11px",fontWeight:"600",color:"white",background:"linear-gradient(135deg, ".concat(R(t.Status)," 0%, ").concat(R(t.Status),"dd 100%)"),boxShadow:"0 2px 6px ".concat(R(t.Status),"30")},children:[T(t.Status)," ",t.Status]})}),(0,a.jsx)("td",{style:{padding:"0.5rem 0.75rem",textAlign:"center",color:"#7f8c8d",fontFamily:"monospace",fontSize:"12px"},children:k(t.Data_Start)}),(0,a.jsx)("td",{style:{padding:"0.5rem 0.75rem",textAlign:"right",fontWeight:"600",color:t.Valoare_Estimata?"#3498db":"#bdc3c7",fontSize:"13px"},children:z(t.Valoare_Estimata)}),(0,a.jsx)("td",{style:{padding:"0.5rem 0.75rem",textAlign:"center",zIndex:20},children:(0,a.jsx)(g,{proiect:{ID_Proiect:t.ID_Subproiect,Denumire:t.Denumire,Client:t.Client||e.Client,Status:t.Status,Valoare_Estimata:t.Valoare_Estimata,Data_Start:t.Data_Start,Data_Final:t.Data_Final,tip:"subproiect",Responsabil:t.Responsabil},onRefresh:v})})]},t.ID_Subproiect))]},e.ID_Proiect)})})]})}),r.length>0&&(0,a.jsxs)("div",{style:{padding:"1.5rem",borderTop:"1px solid rgba(0, 0, 0, 0.08)",background:"rgba(248, 249, 250, 0.8)",backdropFilter:"blur(6px)",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",textAlign:"center",zIndex:1},children:[(0,a.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.7)",padding:"1rem",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.05)"},children:[(0,a.jsx)("div",{style:{fontSize:"12px",color:"#7f8c8d",fontWeight:"500",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Total Proiecte"}),(0,a.jsx)("div",{style:{fontSize:"20px",fontWeight:"700",color:"#2c3e50",marginTop:"0.25rem"},children:r.length})]}),(0,a.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.7)",padding:"1rem",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.05)"},children:[(0,a.jsx)("div",{style:{fontSize:"12px",color:"#7f8c8d",fontWeight:"500",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Total Subproiecte"}),(0,a.jsx)("div",{style:{fontSize:"20px",fontWeight:"700",color:"#3498db",marginTop:"0.25rem"},children:o.length})]}),(0,a.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(39, 174, 96, 0.1) 0%, rgba(46, 204, 113, 0.1) 100%)",padding:"1rem",borderRadius:"12px",border:"1px solid rgba(39, 174, 96, 0.2)",boxShadow:"0 4px 12px rgba(39, 174, 96, 0.1)",gridColumn:"span 2"},children:[(0,a.jsx)("div",{style:{fontSize:"12px",color:"#27ae60",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Valoare Totală Portofoliu"}),(0,a.jsx)("div",{style:{fontSize:"24px",fontWeight:"700",color:"#27ae60",marginTop:"0.25rem"},children:z((()=>{let e=r.reduce((e,t)=>{let r=Number(t.Valoare_Estimata)||0;return e+r},0),t=o.reduce((e,t)=>{let r=Number(t.Valoare_Estimata)||0;return e+r},0),a=e+t;return console.log("\uD83D\uDCB0 Calcul totaluri:",{totalProiecte:e,totalSubproiecte:t,total:a}),a})())}),(0,a.jsx)("div",{style:{fontSize:"11px",color:"#7f8c8d",marginTop:"0.25rem",opacity:.8},children:"Proiecte + Subproiecte combinate"})]})]})]}),u&&(0,a.jsx)("div",{style:{zIndex:5e4},children:(0,a.jsx)(j,{isOpen:u,onClose:()=>x(!1),onProiectAdded:v})})]})}function S(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),[r,i]=(0,n.useState)(!1),[s,c]=(0,n.useState)({search:(null==t?void 0:t.get("search"))||"",status:(null==t?void 0:t.get("status"))||"",client:(null==t?void 0:t.get("client"))||"",data_start_start:(null==t?void 0:t.get("data_start_start"))||"",data_start_end:(null==t?void 0:t.get("data_start_end"))||"",valoare_min:(null==t?void 0:t.get("valoare_min"))||"",valoare_max:(null==t?void 0:t.get("valoare_max"))||""}),p=Object.fromEntries(Object.entries(s).filter(e=>{let[t,r]=e;return""!==r}));return(0,a.jsxs)("div",{style:{padding:"2rem",minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",zIndex:1},className:"jsx-b9d82393daaeb258",children:[(0,a.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"\n          radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.15) 0%, transparent 50%),\n          radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),\n          radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.1) 0%, transparent 50%)\n        ",pointerEvents:"none",zIndex:0},className:"jsx-b9d82393daaeb258"}),(0,a.jsxs)("div",{style:{position:"relative",zIndex:1},className:"jsx-b9d82393daaeb258",children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",padding:"2rem",background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08)",position:"relative",zIndex:10},className:"jsx-b9d82393daaeb258",children:[(0,a.jsxs)("div",{className:"jsx-b9d82393daaeb258",children:[(0,a.jsx)("h1",{style:{margin:0,color:"#2c3e50",fontSize:"2.5rem",fontWeight:"700",background:"linear-gradient(135deg, #2c3e50 0%, #4a6741 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},className:"jsx-b9d82393daaeb258",children:"\uD83D\uDCCB Management Proiecte"}),(0,a.jsx)("p",{style:{margin:"0.75rem 0 0 0",color:"#7f8c8d",fontSize:"1.1rem",fontWeight:"500"},className:"jsx-b9d82393daaeb258",children:"Gestionează și monitorizează toate proiectele din portofoliu"})]}),(0,a.jsxs)("button",{onClick:()=>i(!0),style:{padding:"1rem 2rem",background:"linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)",color:"white",border:"none",borderRadius:"16px",cursor:"pointer",fontSize:"16px",fontWeight:"700",boxShadow:"0 4px 12px rgba(39, 174, 96, 0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",zIndex:11},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px) scale(1.02)",e.currentTarget.style.boxShadow="0 6px 20px rgba(39, 174, 96, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(39, 174, 96, 0.3)"},className:"jsx-b9d82393daaeb258",children:[(0,a.jsx)("span",{style:{position:"relative",zIndex:1},className:"jsx-b9d82393daaeb258",children:"+ Proiect Nou"}),(0,a.jsx)("div",{style:{position:"absolute",top:0,left:"-100%",width:"100%",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)",transition:"left 0.5s ease"},className:"jsx-b9d82393daaeb258"})]})]}),(0,a.jsx)("div",{style:{marginBottom:"2rem",background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"20px",padding:"2rem",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08)",position:"relative",zIndex:10},className:"jsx-b9d82393daaeb258",children:(0,a.jsx)(n.Suspense,{fallback:(0,a.jsxs)("div",{style:{padding:"3rem",textAlign:"center",color:"#7f8c8d",display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"},className:"jsx-b9d82393daaeb258",children:[(0,a.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"50%",border:"3px solid #3498db",borderTop:"3px solid transparent",animation:"spin 1s linear infinite"},className:"jsx-b9d82393daaeb258"}),(0,a.jsx)("span",{style:{fontSize:"16px",fontWeight:"500"},className:"jsx-b9d82393daaeb258",children:"⏳ Se \xeencarcă filtrele..."}),(0,a.jsx)("style",{children:"\n                  @keyframes spin {\n                    0% { transform: rotate(0deg); }\n                    100% { transform: rotate(360deg); }\n                  }\n                "})]}),children:(0,a.jsx)(d,{values:s,onChange:t=>{c(t);let r=new URLSearchParams;Object.entries(t).forEach(e=>{let[t,a]=e;a&&r.set(t,a)});let a=r.toString()?"/admin/rapoarte/proiecte?".concat(r.toString()):"/admin/rapoarte/proiecte";e.push(a)},onReset:()=>{c({search:"",status:"",client:"",data_start_start:"",data_start_end:"",valoare_min:"",valoare_max:""}),e.push("/admin/rapoarte/proiecte")}})})}),(0,a.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"20px",overflow:"hidden",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08)",marginBottom:"2rem",position:"relative",zIndex:10},className:"jsx-b9d82393daaeb258",children:(0,a.jsx)(n.Suspense,{fallback:(0,a.jsxs)("div",{style:{padding:"4rem",textAlign:"center",color:"#7f8c8d",display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"},className:"jsx-b9d82393daaeb258",children:[(0,a.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",border:"4px solid #3498db",borderTop:"4px solid transparent",animation:"spin 1s linear infinite"},className:"jsx-b9d82393daaeb258"}),(0,a.jsx)("span",{style:{fontSize:"18px",fontWeight:"500"},className:"jsx-b9d82393daaeb258",children:"⏳ Se \xeencarcă proiectele..."})]}),children:(0,a.jsx)(v,{searchParams:p})})}),(0,a.jsx)("div",{style:{padding:"1.5rem",background:"rgba(255, 255, 255, 0.75)",backdropFilter:"blur(6px)",borderRadius:"16px",border:"1px solid rgba(255, 255, 255, 0.4)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",textAlign:"center",position:"relative",zIndex:10},className:"jsx-b9d82393daaeb258",children:(0,a.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#6c757d",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},className:"jsx-b9d82393daaeb258",children:["\uD83D\uDCA1 ",(0,a.jsx)("strong",{className:"jsx-b9d82393daaeb258",children:"Tip:"}),' Folosește filtrele pentru a găsi rapid proiectele dorite. Click pe "Acțiuni" pentru a gestiona fiecare proiect individual.']})}),r&&(0,a.jsx)("div",{style:{zIndex:5e4,position:"relative"},className:"jsx-b9d82393daaeb258",children:(0,a.jsx)(j,{isOpen:r,onClose:()=>i(!1),onProiectAdded:()=>{window.location.reload()}})})]}),(0,a.jsx)(o(),{id:"b9d82393daaeb258",children:'[data-modal="true"],.modal-overlay,.modal-container,div[style*="position: fixed"]:not([data-background]){z-index:50000!important}[data-dropdown="true"],.dropdown-menu,.actions-dropdown,div[style*="position: absolute"][style*="background"]:not([data-background]){z-index:40000!important}.toast,.notification,[data-toast="true"]{z-index:60000!important}.loading-overlay,[data-loading="true"]{z-index:45000!important}.tooltip,[data-tooltip="true"]{z-index:35000!important}.modal-backdrop{z-index:49000!important;background:rgba(0,0,0,.5)!important;-webkit-backdrop-filter:blur(2px)!important;backdrop-filter:blur(2px)!important}.main-content,.page-container,.glassmorphism-container{z-index:1!important;position:relative}.modal-container select,.modal-container input,.modal-container textarea,.modal-container button{z-index:inherit!important}.react-select__menu{z-index:51000!important}.modal-container .dropdown-menu,.modal-container .actions-dropdown{z-index:51000!important}'})]})}}},function(e){e.O(0,[259,757,811,121,114,744],function(){return e(e.s=9530)}),_N_E=e.O()}]);