(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{9530:function(e,t,r){Promise.resolve().then(r.bind(r,9469))},7237:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(6705),n=r(955);function i(e){let{data:t,columns:r,loading:i=!1,onRowClick:o,actions:l,emptyMessage:c="Nu sunt date disponibile"}=e,[d,s]=(0,n.useState)(""),[u,p]=(0,n.useState)("asc"),x=e=>{d===e?p("asc"===u?"desc":"asc"):(s(e),p("asc"))},b=[...t].sort((e,t)=>{if(!d)return 0;let r=e[d],a=t[d];return r<a?"asc"===u?-1:1:r>a?"asc"===u?1:-1:0});return i?(0,a.jsx)("div",{style:{background:"white",borderRadius:"8px",padding:"2rem",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:(0,a.jsx)("div",{children:"Se \xeencarcă..."})}):(0,a.jsx)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden"},children:(0,a.jsx)("div",{style:{overflowX:"auto"},children:(0,a.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{background:"#f8f9fa"},children:[r.map(e=>(0,a.jsx)("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #dee2e6",fontWeight:600,color:"#495057",cursor:e.sortable?"pointer":"default",width:e.width,userSelect:"none"},onClick:()=>e.sortable&&x(e.key),children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.label,e.sortable&&(0,a.jsx)("span",{style:{opacity:d===e.key?1:.3},children:d===e.key&&"desc"===u?"↓":"↑"})]})},e.key)),l&&(0,a.jsx)("th",{style:{padding:"1rem",textAlign:"center",borderBottom:"1px solid #dee2e6",fontWeight:600,color:"#495057",width:"120px"},children:"Acțiuni"})]})}),(0,a.jsx)("tbody",{children:0===b.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:r.length+(l?1:0),style:{padding:"2rem",textAlign:"center",color:"#6c757d"},children:c})}):b.map((e,t)=>(0,a.jsxs)("tr",{onClick:()=>null==o?void 0:o(e),style:{cursor:o?"pointer":"default"},onMouseEnter:e=>{o&&(e.currentTarget.style.background="#f8f9fa")},onMouseLeave:e=>{o&&(e.currentTarget.style.background="transparent")},children:[r.map(t=>(0,a.jsx)("td",{style:{padding:"1rem",borderBottom:"1px solid #dee2e6",color:"#495057"},children:t.render?t.render(e[t.key],e):e[t.key]},t.key)),l&&(0,a.jsx)("td",{style:{padding:"1rem",borderBottom:"1px solid #dee2e6",textAlign:"center"},children:l(e)})]},t))})]})})})}},5852:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(6705),n=r(955);function i(e){let{filters:t,values:r,onChange:i,onReset:o,loading:l=!1}=e,[c,d]=(0,n.useState)(!1),s=(e,t)=>{i({...r,[e]:t})},u=Object.values(r).some(e=>""!==e&&null!=e);return(0,a.jsxs)("div",{style:{background:"white",borderRadius:"8px",padding:"1.5rem",marginBottom:"1.5rem",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid #dee2e6"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:c?"1.5rem":"0"},children:[(0,a.jsxs)("h3",{style:{margin:0,color:"#2c3e50",display:"flex",alignItems:"center",gap:"0.5rem"},children:["\uD83D\uDD0D Filtre și Căutare",u&&(0,a.jsx)("span",{style:{background:"#007bff",color:"white",borderRadius:"12px",padding:"2px 8px",fontSize:"12px",fontWeight:"normal"},children:Object.values(r).filter(e=>""!==e&&null!=e).length})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[u&&(0,a.jsx)("button",{onClick:o,disabled:l,style:{padding:"0.5rem 1rem",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontSize:"14px",opacity:l?.6:1},children:"\uD83D\uDD04 Reset"}),(0,a.jsx)("button",{onClick:()=>d(!c),style:{padding:"0.5rem 1rem",background:"transparent",color:"#007bff",border:"1px solid #007bff",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:c?"Ascunde ↑":"Extinde ↓"})]})]}),c&&(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",alignItems:"end"},children:t.map(e=>{var t;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#495057",fontSize:"14px",fontWeight:500},children:e.label}),"text"===e.type&&(0,a.jsx)("input",{type:"text",value:r[e.key]||"",onChange:t=>s(e.key,t.target.value),placeholder:e.placeholder,disabled:l,style:{width:"100%",padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}}),"select"===e.type&&(0,a.jsxs)("select",{value:r[e.key]||"",onChange:t=>s(e.key,t.target.value),disabled:l,style:{width:"100%",padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",background:"white",opacity:l?.6:1},children:[(0,a.jsx)("option",{value:"",children:e.placeholder||"Selectează..."}),null===(t=e.options)||void 0===t?void 0:t.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),"date"===e.type&&(0,a.jsx)("input",{type:"date",value:r[e.key]||"",onChange:t=>s(e.key,t.target.value),disabled:l,style:{width:"100%",padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}}),"dateRange"===e.type&&(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,a.jsx)("input",{type:"date",value:r["".concat(e.key,"_start")]||"",onChange:t=>s("".concat(e.key,"_start"),t.target.value),disabled:l,style:{flex:1,padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}}),(0,a.jsx)("span",{style:{alignSelf:"center",color:"#6c757d"},children:"→"}),(0,a.jsx)("input",{type:"date",value:r["".concat(e.key,"_end")]||"",onChange:t=>s("".concat(e.key,"_end"),t.target.value),disabled:l,style:{flex:1,padding:"0.75rem",border:"1px solid #ced4da",borderRadius:"6px",fontSize:"14px",opacity:l?.6:1}})]})]},e.key)})})]})}},9469:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(6705),n=r(955),i=r(4033),o=r(7237);function l(e){let{actions:t,onAction:r,data:i,disabled:o=!1}=e,[l,c]=(0,n.useState)(!1),d=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let s=e=>{switch(e){case"primary":return"#007bff";case"secondary":return"#6c757d";case"success":return"#28a745";case"warning":return"#ffc107";case"danger":return"#dc3545";default:return"#495057"}},u=e=>{c(!1),r(e,i)};return(0,a.jsxs)("div",{ref:d,style:{position:"relative",display:"inline-block"},children:[(0,a.jsxs)("button",{onClick:()=>c(!l),disabled:o,style:{padding:"0.5rem",background:"transparent",border:"1px solid #dee2e6",borderRadius:"6px",cursor:o?"not-allowed":"pointer",color:"#495057",fontSize:"14px",opacity:o?.6:1,display:"flex",alignItems:"center",gap:"0.25rem"},children:["⚙️",(0,a.jsx)("span",{style:{fontSize:"12px"},children:"▼"})]}),l&&(0,a.jsx)("div",{style:{position:"absolute",top:"100%",right:0,zIndex:1e3,background:"white",border:"1px solid #dee2e6",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"200px",marginTop:"0.25rem"},children:t.map((e,t)=>(0,a.jsxs)("div",{children:[e.divider&&t>0&&(0,a.jsx)("hr",{style:{margin:"0.5rem 0",border:"none",borderTop:"1px solid #dee2e6"}}),(0,a.jsxs)("button",{onClick:()=>u(e.key),disabled:e.disabled,style:{width:"100%",padding:"0.75rem 1rem",background:"transparent",border:"none",textAlign:"left",cursor:e.disabled?"not-allowed":"pointer",color:e.disabled?"#6c757d":s(e.color),fontSize:"14px",opacity:e.disabled?.6:1,display:"flex",alignItems:"center",gap:"0.5rem",transition:"background 0.2s"},onMouseEnter:t=>{e.disabled||(t.currentTarget.style.background="#f8f9fa")},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[e.icon&&(0,a.jsx)("span",{children:e.icon}),e.label]})]},e.key))})]})}function c(e){let{proiect:t,onAction:r}=e,n=[{key:"view",label:"Vezi Detalii",icon:"\uD83D\uDC41️",color:"primary"},{key:"edit",label:"Editează",icon:"✏️",color:"secondary"},{key:"duplicate",label:"Duplică Proiect",icon:"\uD83D\uDCCB",color:"secondary"},{key:"divider1",label:"",divider:!0},{key:"generate_contract",label:"Generează Contract",icon:"\uD83D\uDCC4",color:"success",disabled:"Anulat"===t.Status},{key:"generate_invoice",label:"Creează Factură",icon:"\uD83D\uDCB0",color:"warning",disabled:"Activ"!==t.Status&&"Finalizat"!==t.Status},{key:"send_email",label:"Trimite Email Client",icon:"\uD83D\uDCE7",color:"primary"},{key:"divider2",label:"",divider:!0},{key:"mark_completed",label:"Marchează Finalizat",icon:"✅",color:"success",disabled:"Finalizat"===t.Status||"Anulat"===t.Status},{key:"suspend",label:"Suspendă Proiect",icon:"⏸️",color:"warning",disabled:"Suspendat"===t.Status||"Finalizat"===t.Status},{key:"divider3",label:"",divider:!0},{key:"delete",label:"Șterge Proiect",icon:"\uD83D\uDDD1️",color:"danger"}];return(0,a.jsx)(l,{actions:n,onAction:r,data:t})}function d(e){let{filters:t,onRowClick:r}=e,[i,l]=(0,n.useState)([]),[d,s]=(0,n.useState)(!0);(0,n.useEffect)(()=>{u()},[t]);let u=async()=>{s(!0);try{let e=new URLSearchParams;Object.entries(t).forEach(t=>{let[r,a]=t;a&&e.append(r,a)});let r=await fetch("/api/rapoarte/proiecte?".concat(e));if(r.ok){let e=await r.json();l(e.data||[])}}catch(e){console.error("Eroare la \xeencărcarea proiectelor:",e)}finally{s(!1)}},p=async(e,t)=>{switch(e){case"view":window.open("/admin/rapoarte/proiecte/".concat(t.ID_Proiect),"_blank");break;case"edit":alert("Editare proiect: ".concat(t.ID_Proiect));break;case"generate_contract":try{let e=await fetch("/api/actions/genereaza-contract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({proiectId:t.ID_Proiect})});if(e.ok){let r=await e.blob(),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download="Contract_".concat(t.ID_Proiect,".pdf"),n.click(),alert("Contract generat cu succes!")}}catch(e){alert("Eroare la generarea contractului")}break;case"generate_invoice":alert("Generare factură pentru: ".concat(t.ID_Proiect));break;case"send_email":alert("Trimitere email pentru: ".concat(t.ID_Proiect));break;case"mark_completed":confirm("Sigur vrei să marchezi acest proiect ca finalizat?")&&await x(t.ID_Proiect,"Finalizat");break;case"suspend":confirm("Sigur vrei să suspenzi acest proiect?")&&await x(t.ID_Proiect,"Suspendat");break;case"delete":confirm("Sigur vrei să ștergi acest proiect? Această acțiune nu poate fi anulată!")&&await b(t.ID_Proiect)}},x=async(e,t)=>{try{let r=await fetch("/api/rapoarte/proiecte",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,status:t})});r.ok&&(await u(),alert("Status actualizat la: ".concat(t)))}catch(e){alert("Eroare la actualizarea statusului")}},b=async e=>{try{let t=await fetch("/api/rapoarte/proiecte?id=".concat(e),{method:"DELETE"});t.ok&&(await u(),alert("Proiect șters cu succes"))}catch(e){alert("Eroare la ștergerea proiectului")}},y=e=>e?"object"==typeof e&&e.value?new Date(e.value).toLocaleDateString("ro-RO"):new Date(e).toLocaleDateString("ro-RO"):"-",h=[{key:"ID_Proiect",label:"ID Proiect",sortable:!0,width:"150px",render:e=>(0,a.jsx)("span",{style:{fontFamily:"monospace",fontWeight:500},children:e})},{key:"Denumire",label:"Denumire Proiect",sortable:!0,render:e=>(0,a.jsx)("div",{style:{maxWidth:"300px"},children:(0,a.jsx)("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:(null==e?void 0:e.length)>50?"".concat(e.substring(0,50),"..."):e})})},{key:"Client",label:"Client",sortable:!0,width:"200px"},{key:"Status",label:"Status",sortable:!0,width:"130px",render:e=>{let t={Activ:{color:"#28a745",icon:"\uD83D\uDFE2"},"\xcen lucru":{color:"#ffc107",icon:"\uD83D\uDFE1"},Suspendat:{color:"#fd7e14",icon:"\uD83D\uDFE0"},Finalizat:{color:"#6f42c1",icon:"✅"},Anulat:{color:"#dc3545",icon:"\uD83D\uDD34"}}[e]||{color:"#6c757d",icon:"⚪"};return(0,a.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"12px",fontWeight:500,background:"".concat(t.color,"20"),color:t.color,border:"1px solid ".concat(t.color,"40")},children:[t.icon," ",e]})}},{key:"Data_Start",label:"Data \xcenceput",sortable:!0,width:"120px",render:y},{key:"Data_Final",label:"Data Final",sortable:!0,width:"120px",render:y},{key:"Valoare_Estimata",label:"Valoare",sortable:!0,width:"120px",render:e=>{if(!e)return"-";let t="string"==typeof e?parseFloat(e):e;return new Intl.NumberFormat("ro-RO",{style:"currency",currency:"RON"}).format(t)}}];return(0,a.jsx)(o.Z,{data:i,columns:h,loading:d,onRowClick:r,actions:e=>(0,a.jsx)(c,{proiect:e,onAction:p}),emptyMessage:"Nu sunt proiecte disponibile cu filtrele selectate."})}var s=r(5852);function u(e){let{values:t,onChange:r,onReset:n,loading:i=!1}=e;return(0,a.jsx)(s.Z,{filters:[{key:"search",label:"Căutare generală",type:"text",placeholder:"Caută după nume proiect, client, ID..."},{key:"status",label:"Status proiect",type:"select",placeholder:"Toate statusurile",options:[{value:"Activ",label:"\uD83D\uDFE2 Activ"},{value:"\xcen lucru",label:"\uD83D\uDFE1 \xcen lucru"},{value:"Suspendat",label:"\uD83D\uDFE0 Suspendat"},{value:"Finalizat",label:"✅ Finalizat"},{value:"Anulat",label:"\uD83D\uDD34 Anulat"}]},{key:"client",label:"Client",type:"select",placeholder:"Toți clienții",options:[{value:"SC T&D PRO ELECTRIC SRL",label:"SC T&D PRO ELECTRIC SRL"},{value:"SC PROD SRL",label:"SC PROD SRL"},{value:"SC BUILD SRL",label:"SC BUILD SRL"}]},{key:"data_start",label:"Perioada \xeenceput",type:"dateRange",placeholder:"Data \xeenceput"},{key:"valoare_min",label:"Valoare minimă (RON)",type:"text",placeholder:"0"},{key:"valoare_max",label:"Valoare maximă (RON)",type:"text",placeholder:"999999"}],values:t,onChange:r,onReset:n,loading:i})}function p(){let e=(0,i.useRouter)(),[t,r]=(0,n.useState)({}),[o,l]=(0,n.useState)(!1),c=async()=>{try{let e=new URLSearchParams;Object.entries(t).forEach(t=>{let[r,a]=t;a&&e.append(r,a)});let r=await fetch("/api/rapoarte/proiecte/export?".concat(e));if(r.ok){let e=await r.blob(),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="Proiecte_".concat(new Date().toISOString().split("T")[0],".xlsx"),a.click(),URL.revokeObjectURL(t)}else alert("Eroare la exportul Excel")}catch(e){console.error("Eroare export:",e),alert("Eroare la exportul Excel")}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{style:{margin:0,color:"#2c3e50"},children:"\uD83D\uDCCB Proiecte"}),(0,a.jsx)("p",{style:{margin:"0.5rem 0 0 0",color:"#6c757d"},children:"Gestionează toate proiectele firmei"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,a.jsx)("button",{onClick:()=>{alert("Funcționalitate \xeen dezvoltare - Trimitere raport pe email")},style:{padding:"0.75rem 1.5rem",background:"#17a2b8",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"0.5rem"},children:"\uD83D\uDCE7 Trimite Raport"}),(0,a.jsx)("button",{onClick:c,style:{padding:"0.75rem 1.5rem",background:"#28a745",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"0.5rem"},children:"\uD83D\uDCCA Export Excel"}),(0,a.jsx)("button",{onClick:()=>l(!0),style:{padding:"0.75rem 1.5rem",background:"#007bff",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"0.5rem"},children:"+ Proiect Nou"})]})]}),(0,a.jsx)(u,{values:t,onChange:e=>{r(e)},onReset:()=>{r({})}}),(0,a.jsx)(d,{filters:t,onRowClick:t=>{e.push("/admin/rapoarte/proiecte/".concat(t.ID_Proiect))}}),o&&(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,a.jsxs)("div",{style:{background:"white",borderRadius:"8px",padding:"2rem",maxWidth:"500px",width:"90%"},children:[(0,a.jsx)("h3",{children:"+ Proiect Nou"}),(0,a.jsx)("p",{children:"Funcționalitate \xeen dezvoltare..."}),(0,a.jsx)("button",{onClick:()=>l(!1),style:{padding:"0.5rem 1rem",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"\xcenchide"})]})})]})}},9991:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=r(955),n=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,r){var a,i={},d=null,s=null;for(a in void 0!==r&&(d=""+r),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(s=t.ref),t)o.call(t,a)&&!c.hasOwnProperty(a)&&(i[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===i[a]&&(i[a]=t[a]);return{$$typeof:n,type:e,key:d,ref:s,props:i,_owner:l.current}}t.Fragment=i,t.jsx=d,t.jsxs=d},6705:function(e,t,r){"use strict";e.exports=r(9991)},4033:function(e,t,r){e.exports=r(8165)}},function(e){e.O(0,[121,114,744],function(){return e(e.s=9530)}),_N_E=e.O()}]);