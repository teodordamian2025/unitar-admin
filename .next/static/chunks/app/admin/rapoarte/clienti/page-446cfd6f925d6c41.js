(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642],{3389:function(e,r,t){Promise.resolve().then(t.bind(t,8004))},8004:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return l}});var i=t(6705),o=t(955),n=t(8259);function a(e){let{isOpen:r,onClose:t,onClientAdded:a}=e,[l,d]=(0,o.useState)(!1),[s,c]=(0,o.useState)(!1),p=async()=>{if(!u.cui.trim()){n.Am.error("Introduceți mai \xeent\xe2i CUI-ul");return}try{c(!0),n.Am.info("Verificare date ANAF...");let e=await fetch("/api/verify-anaf?cui=".concat(u.cui)),r=await e.json();r.success&&r.data?(m(e=>({...e,nume:r.data.nume||e.nume,adresa:r.data.adresa||e.adresa})),n.Am.success("Date ANAF \xeencărcate cu succes!")):n.Am.warning("Nu s-au găsit date pentru acest CUI la ANAF")}catch(e){console.error("Eroare verificare ANAF:",e),n.Am.error("Eroare la verificarea ANAF")}finally{c(!1)}},[u,m]=(0,o.useState)({nume:"",tip_client:"persoana_juridica",cui:"",nr_reg_com:"",adresa:"",judet:"",oras:"",cod_postal:"",telefon:"",email:"",banca:"",iban:"",cnp:"",ci_serie:"",ci_numar:"",ci_eliberata_de:"",ci_eliberata_la:"",observatii:""}),x=async e=>{e.preventDefault(),d(!0);try{let e,r;if(!u.nume.trim()){n.Am.error("Numele clientului este obligatoriu"),d(!1);return}if("persoana_juridica"===u.tip_client&&!u.cui.trim()){n.Am.error("CUI-ul este obligatoriu pentru persoane juridice"),d(!1);return}if("persoana_fizica"===u.tip_client&&!u.cnp.trim()){n.Am.error("CNP-ul este obligatoriu pentru persoane fizice"),d(!1);return}console.log("Trimitere date client:",u),n.Am.info("Se adaugă clientul..."),e=await fetch("/api/rapoarte/clienti",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),r=await e.json(),console.log("Response status:",e.status),console.log("Response data:",r),r.success||e.ok?(n.Am.success("Client adăugat cu succes!"),a(),t(),m({nume:"",tip_client:"persoana_juridica",cui:"",nr_reg_com:"",adresa:"",judet:"",oras:"",cod_postal:"",telefon:"",email:"",banca:"",iban:"",cnp:"",ci_serie:"",ci_numar:"",ci_eliberata_de:"",ci_eliberata_la:"",observatii:""})):(console.error("Eroare API:",r),n.Am.error("Eroare: ".concat(r.error||"Eroare necunoscută")))}catch(e){console.error("Eroare la adăugarea clientului:",e),n.Am.error("Eroare la adăugarea clientului")}finally{d(!1)}},g=(e,r)=>{m(t=>({...t,[e]:r}))};return r?(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:(0,i.jsxs)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)",maxWidth:"800px",width:"100%",maxHeight:"90vh",overflowY:"auto"},children:[(0,i.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #dee2e6",background:"#f8f9fa",borderRadius:"8px 8px 0 0"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("h2",{style:{margin:0,color:"#2c3e50"},children:"\uD83D\uDC64 Adaugă Client Nou"}),(0,i.jsx)("button",{onClick:t,disabled:l,style:{background:"transparent",border:"none",fontSize:"24px",cursor:"pointer",color:"#6c757d"},children:"\xd7"})]}),(0,i.jsx)("p",{style:{margin:"0.5rem 0 0 0",color:"#7f8c8d",fontSize:"14px"},children:"Clientul va fi adăugat automat \xeen BigQuery și sincronizat cu factureaza.me"})]}),(0,i.jsxs)("form",{onSubmit:x,style:{padding:"1.5rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Tip client *"}),(0,i.jsxs)("select",{value:u.tip_client,onChange:e=>g("tip_client",e.target.value),disabled:l,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"},children:[(0,i.jsx)("option",{value:"persoana_juridica",children:"Persoană Juridică"}),(0,i.jsx)("option",{value:"persoana_fizica",children:"Persoană Fizică"})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Nume *"}),(0,i.jsx)("input",{type:"text",value:u.nume,onChange:e=>g("nume",e.target.value),disabled:l,placeholder:"Numele clientului",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),"persoana_juridica"===u.tip_client?(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"CUI *"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,i.jsx)("input",{type:"text",value:u.cui,onChange:e=>g("cui",e.target.value),disabled:l,placeholder:"RO12345678",style:{flex:1,padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}}),(0,i.jsx)("button",{type:"button",onClick:p,disabled:l||s||!u.cui.trim(),style:{padding:"0.75rem 1rem",background:s?"#bdc3c7":"#e74c3c",color:"white",border:"none",borderRadius:"6px",cursor:l||s||!u.cui.trim()?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",whiteSpace:"nowrap"},children:s?"⏳":"\uD83C\uDFDB️ ANAF"})]})]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"CNP *"}),(0,i.jsx)("input",{type:"text",value:u.cnp,onChange:e=>g("cnp",e.target.value),disabled:l,placeholder:"1234567890123",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]})]}),"persoana_juridica"===u.tip_client&&(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Nr. Reg. Com."}),(0,i.jsx)("input",{type:"text",value:u.nr_reg_com,onChange:e=>g("nr_reg_com",e.target.value),disabled:l,placeholder:"J40/1234/2020",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Adresă"}),(0,i.jsx)("input",{type:"text",value:u.adresa,onChange:e=>g("adresa",e.target.value),disabled:l,placeholder:"Strada, numărul, sectorul/comuna",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Județ"}),(0,i.jsx)("input",{type:"text",value:u.judet,onChange:e=>g("judet",e.target.value),disabled:l,placeholder:"București",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Oraș"}),(0,i.jsx)("input",{type:"text",value:u.oras,onChange:e=>g("oras",e.target.value),disabled:l,placeholder:"București",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Cod Poștal"}),(0,i.jsx)("input",{type:"text",value:u.cod_postal,onChange:e=>g("cod_postal",e.target.value),disabled:l,placeholder:"010123",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Telefon"}),(0,i.jsx)("input",{type:"tel",value:u.telefon,onChange:e=>g("telefon",e.target.value),disabled:l,placeholder:"0123456789",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Email"}),(0,i.jsx)("input",{type:"email",value:u.email,onChange:e=>g("email",e.target.value),disabled:l,placeholder:"contact@client.ro",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Bancă"}),(0,i.jsx)("input",{type:"text",value:u.banca,onChange:e=>g("banca",e.target.value),disabled:l,placeholder:"Banca Transilvania",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"IBAN"}),(0,i.jsx)("input",{type:"text",value:u.iban,onChange:e=>g("iban",e.target.value),disabled:l,placeholder:"RO49AAAA1B31007593840000",style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px"}})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold",color:"#2c3e50"},children:"Observații"}),(0,i.jsx)("textarea",{value:u.observatii,onChange:e=>g("observatii",e.target.value),disabled:l,placeholder:"Observații despre client...",rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #dee2e6",borderRadius:"6px",fontSize:"14px",resize:"vertical"}})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem",paddingTop:"1rem",borderTop:"1px solid #dee2e6"},children:[(0,i.jsx)("button",{type:"button",onClick:t,disabled:l,style:{padding:"0.75rem 1.5rem",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Anulează"}),(0,i.jsx)("button",{type:"submit",disabled:l,style:{padding:"0.75rem 1.5rem",background:l?"#bdc3c7":"#27ae60",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:l?"⏳ Se adaugă...":"\uD83D\uDCBE Adaugă Client"})]})]})]})}):null}function l(){let[e,r]=(0,o.useState)([]),[t,l]=(0,o.useState)(!0),[d,s]=(0,o.useState)(!1),[c,p]=(0,o.useState)(!1);(0,o.useEffect)(()=>{u()},[]);let u=async()=>{try{l(!0);let e=await fetch("/api/rapoarte/clienti"),t=await e.json();t.success?r(t.data||[]):(n.Am.error("Eroare la \xeencărcarea clienților"),r([]))}catch(e){console.error("Eroare la \xeencărcarea clienților:",e),n.Am.error("Eroare de conectare"),r([])}finally{l(!1)}},m=async()=>{try{p(!0),n.Am.info("Se sincronizează clienții din factureaza.me...");let e=await fetch("/api/actions/clients/sync-factureaza",{method:"GET"}),r=await e.json();r.success?(n.Am.success("Sincronizare completă: ".concat(r.syncedCount," clienți adăugați")),r.errorCount>0&&n.Am.warning("".concat(r.errorCount," erori \xeen timpul sincronizării")),u()):n.Am.error("Eroare la sincronizare: ".concat(r.error))}catch(e){n.Am.error("Eroare la sincronizarea cu factureaza.me")}finally{p(!1)}},x=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("ro-RO")}catch(e){return""}},g=e=>"persoana_juridica"===e?"\uD83C\uDFE2":"\uD83D\uDC64",h=e=>e?"✅":"⚠️";return t?(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",fontSize:"16px",color:"#7f8c8d"},children:"⏳ Se \xeencarcă clienții..."}):(0,i.jsxs)("div",{style:{padding:"1.5rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"2rem",borderBottom:"2px solid #e9ecef",paddingBottom:"1rem"},children:[(0,i.jsx)("h1",{style:{margin:0,color:"#2c3e50",fontSize:"2rem",fontWeight:"bold"},children:"\uD83D\uDC65 Management Clienți"}),(0,i.jsx)("p",{style:{margin:"0.5rem 0 0 0",color:"#7f8c8d",fontSize:"1.1rem"},children:"Gestionează clienții și sincronizează cu factureaza.me"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{style:{margin:0,color:"#2c3e50"},children:["\uD83D\uDC65 Clienți găsiți: ",e.length]}),(0,i.jsxs)("p",{style:{margin:"0.25rem 0 0 0",fontSize:"14px",color:"#7f8c8d"},children:[e.filter(e=>e.sincronizat_factureaza).length," sincronizați cu factureaza.me"]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,i.jsx)("button",{onClick:()=>s(!0),style:{padding:"0.5rem 1rem",background:"#27ae60",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"+ Client Nou"}),(0,i.jsx)("button",{onClick:m,disabled:c,style:{padding:"0.5rem 1rem",background:c?"#bdc3c7":"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:c?"⏳ Sincronizare...":"\uD83D\uDD04 Sync factureaza.me"}),(0,i.jsx)("button",{onClick:u,style:{padding:"0.5rem 1rem",background:"#f39c12",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"\uD83D\uDD04 Re\xeemprospătează"})]})]}),0===e.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"3rem",background:"#f8f9fa",borderRadius:"8px",border:"2px dashed #dee2e6"},children:[(0,i.jsx)("p",{style:{fontSize:"18px",color:"#7f8c8d",margin:0},children:"\uD83D\uDC65 Nu au fost găsiți clienți"}),(0,i.jsx)("p",{style:{fontSize:"14px",color:"#bdc3c7",margin:"0.5rem 0"},children:"Adaugă primul client sau sincronizează din factureaza.me"}),(0,i.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,i.jsx)("button",{onClick:()=>s(!0),style:{padding:"0.75rem 1.5rem",background:"#27ae60",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",marginRight:"1rem"},children:"+ Adaugă Client"}),(0,i.jsx)("button",{onClick:m,disabled:c,style:{padding:"0.75rem 1.5rem",background:c?"#bdc3c7":"#3498db",color:"white",border:"none",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold"},children:c?"⏳ Sincronizare...":"Sincronizează din factureaza.me"})]})]}):(0,i.jsx)("div",{style:{background:"white",borderRadius:"8px",border:"1px solid #dee2e6",overflow:"hidden",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #dee2e6"},children:[(0,i.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"left",fontWeight:"bold",color:"#2c3e50"},children:"Tip"}),(0,i.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"left",fontWeight:"bold",color:"#2c3e50"},children:"Nume"}),(0,i.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"left",fontWeight:"bold",color:"#2c3e50"},children:"CUI/CNP"}),(0,i.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"left",fontWeight:"bold",color:"#2c3e50"},children:"Contact"}),(0,i.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"left",fontWeight:"bold",color:"#2c3e50"},children:"Localitate"}),(0,i.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"center",fontWeight:"bold",color:"#2c3e50"},children:"factureaza.me"}),(0,i.jsx)("th",{style:{padding:"1rem 0.75rem",textAlign:"center",fontWeight:"bold",color:"#2c3e50"},children:"Data Creare"})]})}),(0,i.jsx)("tbody",{children:e.map((e,r)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #f1f2f6",background:r%2==0?"white":"#fafbfc"},children:[(0,i.jsx)("td",{style:{padding:"0.75rem",textAlign:"center"},children:(0,i.jsx)("span",{style:{fontSize:"18px"},children:g(e.tip_client)})}),(0,i.jsx)("td",{style:{padding:"0.75rem",color:"#2c3e50",fontWeight:"bold"},children:e.nume}),(0,i.jsx)("td",{style:{padding:"0.75rem",color:"#7f8c8d",fontFamily:"monospace"},children:e.cui||e.cnp||"-"}),(0,i.jsxs)("td",{style:{padding:"0.75rem",color:"#2c3e50"},children:[(0,i.jsx)("div",{children:e.email||"-"}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#7f8c8d"},children:e.telefon||"-"})]}),(0,i.jsxs)("td",{style:{padding:"0.75rem",color:"#2c3e50"},children:[(0,i.jsx)("div",{children:e.oras||"-"}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#7f8c8d"},children:e.judet||"-"})]}),(0,i.jsx)("td",{style:{padding:"0.75rem",textAlign:"center"},children:(0,i.jsxs)("span",{style:{fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:[h(e.sincronizat_factureaza),(0,i.jsx)("span",{style:{fontSize:"12px",color:e.sincronizat_factureaza?"#27ae60":"#f39c12"},children:e.sincronizat_factureaza?"Sync":"Local"})]})}),(0,i.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",color:"#7f8c8d",fontSize:"12px",fontFamily:"monospace"},children:x(e.data_creare)})]},e.id))})]})}),(0,i.jsx)(a,{isOpen:d,onClose:()=>s(!1),onClientAdded:u})]})}},9991:function(e,r,t){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=t(955),o=Symbol.for("react.element"),n=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function s(e,r,t){var i,n={},s=null,c=null;for(i in void 0!==t&&(s=""+t),void 0!==r.key&&(s=""+r.key),void 0!==r.ref&&(c=r.ref),r)a.call(r,i)&&!d.hasOwnProperty(i)&&(n[i]=r[i]);if(e&&e.defaultProps)for(i in r=e.defaultProps)void 0===n[i]&&(n[i]=r[i]);return{$$typeof:o,type:e,key:s,ref:c,props:n,_owner:l.current}}r.Fragment=n,r.jsx=s,r.jsxs=s},6705:function(e,r,t){"use strict";e.exports=t(9991)}},function(e){e.O(0,[259,121,114,744],function(){return e(e.s=3389)}),_N_E=e.O()}]);