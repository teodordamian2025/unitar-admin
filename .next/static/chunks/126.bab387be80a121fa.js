"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126,904],{3904:function(e,t,r){r.r(t),r.d(t,{default:function(){return i}});var n=r(6705),o=r(955),a=r(8647);function i(){let[e,t]=(0,o.useState)([]),[r,i]=(0,o.useState)(""),[c,l]=(0,o.useState)(!1),[s,d]=(0,o.useState)(null),p=(0,o.useRef)(null),u=async()=>{let e=r.trim();if(!e)return;let n={from:"user",text:e};t(e=>[...e,n]),i(""),l(!0);try{let r=e.toLowerCase(),n=r.includes("excel")?"xlsx":r.includes("pdf")?"pdf":r.includes("word")||r.includes(".docx")?"docx":null;if(n){let r=await fetch("/api/genereaza/".concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,format:n})}),o=await r.blob(),a=URL.createObjectURL(o),i="document.".concat(n),c={from:"bot",text:'Document generat: <a href="'.concat(a,'" download="').concat(i,'">Descarcă ').concat(i,"</a>")};t(e=>[...e,c])}else if(s){let r=s.name.toLowerCase().split(".").pop(),n=["pdf","xlsx","docx"].includes(r||"")?"/api/proceseaza-upload/".concat(r):"/api/proceseaza-upload",o=new FormData;o.append("file",s),o.append("prompt",e);let a=await fetch(n,{method:"POST",body:o}),i=a.headers.get("Content-Type")||"";if(i.startsWith("application/json")){let e=await a.json(),r={from:"bot",text:e.reply||"Fără răspuns."};t(e=>[...e,r])}else{let e=await a.blob(),r=URL.createObjectURL(e),n=a.headers.get("X-Filename")||s.name,o={from:"bot",text:'Document generat: <a href="'.concat(r,'" download="').concat(n,'">Descarcă ').concat(n,"</a>")};t(e=>[...e,o])}d(null)}else{let r=await fetch("/api/queryOpenAI",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),n=await r.json(),o={from:"bot",text:n.reply||"Fără răspuns."};t(e=>[...e,o])}}catch(e){console.error("Eroare chatbot:",e),t(e=>[...e,{from:"bot",text:"Eroare la conectare cu serverul."}])}l(!1)},f=(0,o.useCallback)(e=>{let r=e[0];r&&(d(r),t(e=>[...e,{from:"user",text:"Am \xeencărcat fișierul: ".concat(r.name)}]))},[]),{getRootProps:x,getInputProps:h,isDragActive:b}=(0,a.uI)({onDrop:f});return(0,o.useEffect)(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),(0,n.jsxs)("div",{style:{position:"fixed",bottom:"10px",right:"10px",width:"340px",background:"#fefefe",border:"1px solid #ccc",borderRadius:"8px",zIndex:9999,boxShadow:"0 0 10px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",maxHeight:"90vh"},children:[(0,n.jsx)("div",{style:{background:"#4caf50",color:"white",padding:"10px",textAlign:"center",fontWeight:"bold",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:"Asistent AI"}),(0,n.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"10px",paddingBottom:"0"},children:[e.map((e,t)=>(0,n.jsx)("div",{style:{textAlign:"user"===e.from?"right":"left",margin:"5px 0"},children:(0,n.jsx)("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:"12px",background:"user"===e.from?"#dcf8c6":"#e0e0e0",maxWidth:"90%",wordWrap:"break-word"},children:e.text.startsWith("Document generat")?(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:e.text}}):e.text})},t)),(0,n.jsx)("div",{ref:p})]}),(0,n.jsxs)("div",{style:{padding:"10px",borderTop:"1px solid #ccc"},children:[(0,n.jsx)("textarea",{rows:3,value:r,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),u())},placeholder:"Scrie un mesaj... (Ctrl+Enter pentru a trimite)",style:{width:"100%",resize:"none",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px"}}),(0,n.jsxs)("div",{...x(),style:{border:"2px dashed #aaa",padding:"6px",textAlign:"center",marginTop:"6px",cursor:"pointer",borderRadius:"6px",background:b?"#eee":"#fafafa"},children:[(0,n.jsx)("input",{...h()}),b?"Lasa fișierele aici...":"\xcencarcă fișier"]}),(0,n.jsx)("button",{onClick:u,disabled:c,style:{marginTop:"8px",width:"100%",padding:"8px",background:"#4caf50",color:"white",border:"none",borderRadius:"6px",cursor:c?"not-allowed":"pointer"},children:c?"Se generează...":"Trimite"})]})]})}},44:function(e,t,r){function n(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)0>t.indexOf(n[o])&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function o(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{l(n.next(e))}catch(e){a(e)}}function c(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(i,c)}l((n=n.apply(e,t||[])).next())})}r.d(t,{_T:function(){return n},mG:function(){return o}}),"function"==typeof SuppressedError&&SuppressedError}}]);