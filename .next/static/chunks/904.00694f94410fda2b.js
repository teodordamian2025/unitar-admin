"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{3904:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});var n=a(6705),i=a(955),r=a(8647);function s(){let[e,t]=(0,i.useState)([]),[a,s]=(0,i.useState)(""),[c,o]=(0,i.useState)(!1),[d,l]=(0,i.useState)(null),[u]=(0,i.useState)(()=>Math.random().toString(36).substr(2,9)),p=(0,i.useRef)(null),x=async()=>{let e=a.trim();if(!e)return;let n={from:"user",text:e};t(e=>[...e,n]),s(""),o(!0);try{let a=e.toLowerCase(),n=a.includes("excel")?"xlsx":a.includes("pdf")?"pdf":a.includes("word")||a.includes(".docx")?"docx":a.includes("text")||a.includes(".txt")?"txt":null;if(n){let a=await fetch("/api/genereaza/".concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,format:n})}),i=await a.blob(),r=URL.createObjectURL(i),s="document.".concat(n),c={from:"bot",text:'Document generat: <a href="'.concat(r,'" download="').concat(s,'">Descarcă ').concat(s,"</a>")};t(e=>[...e,c])}else if(d){let a=d.name.toLowerCase().split(".").pop(),n=["pdf","xlsx","docx","txt"].includes(a||"")?"/api/proceseaza-upload/".concat(a):"/api/proceseaza-upload",i=new FormData;i.append("file",d),i.append("prompt",e);let r=await fetch(n,{method:"POST",body:i}),s=r.headers.get("Content-Type")||"";if(s.startsWith("application/json")){let e=await r.json(),a={from:"bot",text:e.reply||"Fără răspuns."};t(e=>[...e,a])}else{let e=await r.blob(),a=URL.createObjectURL(e),n=r.headers.get("X-Filename")||d.name,i={from:"bot",text:'Document generat: <a href="'.concat(a,'" download="').concat(n,'">Descarcă ').concat(n,"</a>")};t(e=>[...e,i])}l(null)}else{let n=a.includes("client")||a.includes("proiect")||a.includes("factură")||a.includes("facturi")||a.includes("contract")||a.includes("contracte")||a.includes("tranzacți")||a.includes("bancă")||a.includes("subproiect")||a.includes("adaugă")||a.includes("actualizează")||a.includes("șterge")||a.includes("caută")||a.includes("tabele")||a.includes("baza de date")||a.includes("bigquery")||a.includes("c\xe2te")||a.includes("arată")||a.includes("lista")||a.includes("toate")||a.includes("structura")||a.includes("schema")||a.includes("inserează")||a.includes("selectează")||a.includes("panoucontrolunitar")||a.includes("dataset")||a.includes("bancatranzactii")||a.includes("emise")||a.includes("primite")||a.includes("suma")||a.includes("buget")||a.includes("total")||a.includes("raport")||a.includes("statistici")||a.includes("confirm")||a.includes("execută");if(n){let a=await fetch("/api/ai-database",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,sessionId:u})}),n=await a.json();if(n.success){let e={from:"bot",text:n.reply||"Fără răspuns."};t(t=>[...t,e])}else{let a=await fetch("/api/queryOpenAI",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),n=await a.json(),i={from:"bot",text:n.reply||"Fără răspuns."};t(e=>[...e,i])}}else{let a=await fetch("/api/queryOpenAI",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),n=await a.json(),i={from:"bot",text:n.reply||"Fără răspuns."};t(e=>[...e,i])}}}catch(e){console.error("Eroare chatbot:",e),t(e=>[...e,{from:"bot",text:"Eroare la conectare cu serverul."}])}o(!1)},f=(0,i.useCallback)(e=>{let a=e[0];a&&(l(a),t(e=>[...e,{from:"user",text:"Am \xeencărcat fișierul: ".concat(a.name)}]))},[]),{getRootProps:b,getInputProps:h,isDragActive:m}=(0,r.uI)({onDrop:f});return(0,i.useEffect)(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),(0,n.jsxs)("div",{style:{position:"fixed",bottom:"10px",right:"10px",width:"340px",background:"#fefefe",border:"1px solid #ccc",borderRadius:"8px",zIndex:9999,boxShadow:"0 0 10px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",maxHeight:"90vh"},children:[(0,n.jsx)("div",{style:{background:"#4caf50",color:"white",padding:"10px",textAlign:"center",fontWeight:"bold",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:"Asistent AI"}),(0,n.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"10px",paddingBottom:"0"},children:[e.map((e,t)=>(0,n.jsx)("div",{style:{textAlign:"user"===e.from?"right":"left",margin:"5px 0"},children:(0,n.jsx)("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:"12px",background:"user"===e.from?"#dcf8c6":"#e0e0e0",maxWidth:"90%",wordWrap:"break-word"},children:e.text.startsWith("Document generat")?(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:e.text}}):e.text})},t)),(0,n.jsx)("div",{ref:p})]}),(0,n.jsxs)("div",{style:{padding:"10px",borderTop:"1px solid #ccc"},children:[(0,n.jsx)("textarea",{rows:3,value:a,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),x())},placeholder:"Scrie un mesaj... (Ctrl+Enter pentru a trimite)",style:{width:"100%",resize:"none",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px"}}),(0,n.jsxs)("div",{...b(),style:{border:"2px dashed #aaa",padding:"6px",textAlign:"center",marginTop:"6px",cursor:"pointer",borderRadius:"6px",background:m?"#eee":"#fafafa"},children:[(0,n.jsx)("input",{...h()}),m?"Lasa fișierele aici...":"\xcencarcă fișier"]}),(0,n.jsx)("button",{onClick:x,disabled:c,style:{marginTop:"8px",width:"100%",padding:"8px",background:"#4caf50",color:"white",border:"none",borderRadius:"6px",cursor:c?"not-allowed":"pointer"},children:c?"Se generează...":"Trimite"})]})]})}}}]);