"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{3904:function(e,t,r){r.r(t),r.d(t,{default:function(){return i}});var a=r(6705),o=r(955),n=r(8647);function i(){let[e,t]=(0,o.useState)([]),[r,i]=(0,o.useState)(""),[d,c]=(0,o.useState)(!1),[s,l]=(0,o.useState)(null),p=(0,o.useRef)(null),u=async()=>{let e=r.trim();if(!e)return;let a={from:"user",text:e};t(e=>[...e,a]),i(""),c(!0);try{let r=e.toLowerCase(),a=r.includes("excel")?"xlsx":r.includes("pdf")?"pdf":r.includes("word")||r.includes(".docx")?"docx":null;if(a){let r=await fetch("/api/genereaza-document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,format:a})}),o=await r.blob(),n=URL.createObjectURL(o),i="document.".concat(a),d={from:"bot",text:'Document generat: <a href="'.concat(n,'" download="').concat(i,'">Descarcă ').concat(i,"</a>")};t(e=>[...e,d])}else if(s){let r=new FormData;r.append("file",s),r.append("prompt",e);let a=await fetch("/api/proceseaza-upload",{method:"POST",body:r}),o=a.headers.get("Content-Type")||"";if(o.startsWith("application/json")){let e=await a.json(),r={from:"bot",text:e.reply||"Fără răspuns."};t(e=>[...e,r])}else{let e=await a.blob(),r=URL.createObjectURL(e),o=a.headers.get("X-Filename")||s.name,n={from:"bot",text:'Document generat: <a href="'.concat(r,'" download="').concat(o,'">Descarcă ').concat(o,"</a>")};t(e=>[...e,n])}l(null)}else{let r=await fetch("/api/queryOpenAI",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),a=await r.json(),o={from:"bot",text:a.reply||"Fără răspuns."};t(e=>[...e,o])}}catch(e){t(e=>[...e,{from:"bot",text:"Eroare la conectare cu serverul."}])}c(!1)},x=(0,o.useCallback)(e=>{let r=e[0];r&&(l(r),t(e=>[...e,{from:"user",text:"Am \xeencărcat fișierul: ".concat(r.name)}]))},[]),{getRootProps:f,getInputProps:h,isDragActive:b}=(0,n.uI)({onDrop:x});return(0,o.useEffect)(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),(0,a.jsxs)("div",{style:{position:"fixed",bottom:"10px",right:"10px",width:"340px",background:"#fefefe",border:"1px solid #ccc",borderRadius:"8px",zIndex:9999,boxShadow:"0 0 10px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",maxHeight:"90vh"},children:[(0,a.jsx)("div",{style:{background:"#4caf50",color:"white",padding:"10px",textAlign:"center",fontWeight:"bold",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:"Asistent AI"}),(0,a.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"10px",paddingBottom:"0"},children:[e.map((e,t)=>(0,a.jsx)("div",{style:{textAlign:"user"===e.from?"right":"left",margin:"5px 0"},children:(0,a.jsx)("span",{style:{display:"inline-block",padding:"6px 10px",borderRadius:"12px",background:"user"===e.from?"#dcf8c6":"#e0e0e0",maxWidth:"90%",wordWrap:"break-word"},children:e.text.startsWith("Document generat")?(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:e.text}}):e.text})},t)),(0,a.jsx)("div",{ref:p})]}),(0,a.jsxs)("div",{style:{padding:"10px",borderTop:"1px solid #ccc"},children:[(0,a.jsx)("textarea",{rows:3,value:r,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),u())},placeholder:"Scrie un mesaj... (Ctrl+Enter pentru a trimite)",style:{width:"100%",resize:"none",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px"}}),(0,a.jsxs)("div",{...f(),style:{border:"2px dashed #aaa",padding:"6px",textAlign:"center",marginTop:"6px",cursor:"pointer",borderRadius:"6px",background:b?"#eee":"#fafafa"},children:[(0,a.jsx)("input",{...h()}),b?"Lasa fișierele aici...":"\xcencarcă fișier"]}),(0,a.jsx)("button",{onClick:u,disabled:d,style:{marginTop:"8px",width:"100%",padding:"8px",background:"#4caf50",color:"white",border:"none",borderRadius:"6px",cursor:d?"not-allowed":"pointer"},children:d?"Se generează...":"Trimite"})]})]})}}}]);